[{"content":"åœ¨windowsä¸­ä½¿ç”¨mingwç¼–è¯‘vtkå­˜åœ¨ä¸å°‘é—®é¢˜, æµ‹è¯•äº†å‡ ä¸ªé«˜äºvtk-v9.1.0çš„ç‰ˆæœ¬éƒ½å­˜åœ¨ä¸€äº›é—®é¢˜å¯¼è‡´æ— æ³•æ­£å¸¸ç¼–è¯‘, æœ¬æ–‡è®°å½•ä¸‹ç¼–è¯‘è¿‡ç¨‹\nç›¸å…³èµ„æºä¸‹è½½åœ°å€ cmake-3.31.4-windows-x86_64.msi\nvtk-v9.1.0\nVTKç¼–è¯‘ \u0026amp; å®‰è£… å‰ç½®æ“ä½œ: å°†Qt5.15.2ä¸­çš„mingw810_64çš„binç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­,å¹¶é‡å¯æ“ä½œç³»ç»Ÿ, å¦‚: C:\\Qt\\Tools\\mingw810_64\\bin æ‰“å¼€C:\\Qt\\Tools\\mingw810_64\\x86_64-w64-mingw32\\include\\winerror.hæ–‡ä»¶æœç´¢ERROR_INCORRECT_SIZE __MSABI_LONG, æŸ¥çœ‹è¯¥å®šä¹‰ä¸‹é¢æ˜¯å¦æœ‰ä»¥ä¸‹å®šä¹‰, æ²¡æœ‰çš„è¯åŠ ä¸Š:\n#define ERROR_SYMLINK_CLASS_DISABLED 1463 #define ERROR_SYMLINK_NOT_SUPPORTED 1464 #define ERROR_XML_PARSE_ERROR 1465 #define ERROR_XMLDSIG_ERROR 1466 #define ERROR_RESTART_APPLICATION 1467 #define ERROR_WRONG_COMPARTMENT 1468 #define ERROR_AUTHIP_FAILURE 1469 #define ERROR_NO_NVRAM_RESOURCES 1470 ä¸‹è½½å¹¶å®‰è£…cmake\nä¸‹è½½å¹¶è§£å‹vtk-v9.1.0\nè¿›å…¥vtk-v9.1.0ç›®å½•ä¸‹åˆ›å»ºbuildæ–‡ä»¶å¤¹\næ‰“å¼€cmake-guiå¯¹vtk-v9.1.0è¿›è¡Œé…ç½®\nè®¾ç½®æºç å’Œç¼–è¯‘è·¯å¾„\nç‚¹å‡»ConfigureæŒ‰é’®, é€‰æ‹©MinGW Makefiles, ç„¶åç‚¹å‡»Finish\néœ€è¦ç­‰å¾…CMakeè¿›è¡Œä¸€äº›é…ç½®, ç„¶åä¼šå‡ºç°ä¸€äº›æ–°çš„é€‰é¡¹, ä¸‹é¢æ˜¯ä¸€äº›æˆ‘ä»¬è¦é…ç½®çš„é€‰é¡¹, å…ˆé€‰ä¸­ç•Œé¢ä¸Šçš„Advancedå¤é€‰æ¡†:\nName Value æè¿° CMAKE_CXX_FLAGS -fcommon - CMAKE_C_FLAGS -fcommon - CMAKE_BUILD_TYPE Release ä»¥Releaseçš„æ¨¡å¼è¿›è¡Œç¼–è¯‘ CMAKE_INSTALL_PREFIX C:\\Library\\VTK æ‰§è¡Œmake installæ—¶çš„å®‰è£…è·¯å¾„ VTK_GROUP_ENABLE_Qt YES ä½¿èƒ½Qté€‰é¡¹ ç„¶åå†æ¬¡ç‚¹å‡»ConfigureæŒ‰é’®, ç°åœ¨æŠŠAdvancedå¤é€‰æ¡†å–æ¶ˆé€‰ä¸­, å¯ä»¥çœ‹åˆ°æœ€ä¸Šé¢æœ‰ä»¥ä¸‹ä¸‰ä¸ªé…ç½®é¡¹, è¯·æ ¹æ®æˆ‘çš„è¿›è¡Œä¿®æ”¹:\nName Value æè¿° Qt5_DIR C:\\Qt\\5.15.2\\mingw81_64\\lib\\cmake\\Qt5 Qt5è·¯å¾„ Qt6_DIR Qt6_DIR-NOTFOUND Qt6è·¯å¾„(è¿™é‡Œä¸éœ€è¦é…ç½®) VTK_QT_VERSION 5 ä½¿ç”¨Qt5 ç„¶åå†æ¬¡ç‚¹å‡»ConfigureæŒ‰é’®, è¿™æ—¶å€™ä¼šå‘ç°å¤šå‡ºæ¥å¾ˆå¤šQtç›¸å…³çš„é…ç½®é¡¹, ç›´æ¥å†æ¬¡ç‚¹å‡»ConfigureæŒ‰é’®, é…ç½®é¡¹çš„çº¢è‰²åŒºåŸŸå…¨éƒ¨æ¶ˆå¤±, ç„¶åç‚¹å‡»GenerateæŒ‰é’®ç”Ÿæˆ\næ‰“å¼€CMD, è¿›å…¥vtk-v9.1.0\\buildç›®å½•, ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼€å§‹ç¼–è¯‘:\nmingw32-make.exe -j 16 æœ€åæ‰§è¡Œå®‰è£…æŒ‡ä»¤, å°†åŠ¨æ€åº“å‘å¸ƒåˆ°CMAKE_INSTALL_PREFIXå‚æ•°æŒ‡å®šçš„ç›®å½•ä¸‹\nmingw32-make.exe install ","permalink":"https://fake-rick.github.io/posts/windows%E7%B3%BB%E7%BB%9Fvtk-v9.1.0%E4%BD%BF%E7%94%A8qt5.15.2%E8%87%AA%E5%B8%A6mingw810_64%E8%BF%9B%E8%A1%8C%E7%BC%96%E8%AF%91/","summary":"\u003cp\u003eåœ¨windowsä¸­ä½¿ç”¨mingwç¼–è¯‘vtkå­˜åœ¨ä¸å°‘é—®é¢˜, æµ‹è¯•äº†å‡ ä¸ªé«˜äºvtk-v9.1.0çš„ç‰ˆæœ¬éƒ½å­˜åœ¨ä¸€äº›é—®é¢˜å¯¼è‡´æ— æ³•æ­£å¸¸ç¼–è¯‘, æœ¬æ–‡è®°å½•ä¸‹ç¼–è¯‘è¿‡ç¨‹\u003c/p\u003e\n\u003ch2 id=\"ç›¸å…³èµ„æºä¸‹è½½åœ°å€\"\u003eç›¸å…³èµ„æºä¸‹è½½åœ°å€\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/Kitware/CMake/releases/download/v3.31.4/cmake-3.31.4-windows-x86_64.msi\"\u003ecmake-3.31.4-windows-x86_64.msi\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gitlab.kitware.com/vtk/vtk/-/archive/v9.1.0/vtk-v9.1.0.zip\"\u003evtk-v9.1.0\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"vtkç¼–è¯‘--å®‰è£…\"\u003eVTKç¼–è¯‘ \u0026amp; å®‰è£…\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eå‰ç½®æ“ä½œ: å°†Qt5.15.2ä¸­çš„mingw810_64çš„binç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­,å¹¶é‡å¯æ“ä½œç³»ç»Ÿ, å¦‚: \u003ccode\u003eC:\\Qt\\Tools\\mingw810_64\\bin\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"./imgs/path.png\" alt=\"\"  /\u003e\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eæ‰“å¼€\u003ccode\u003eC:\\Qt\\Tools\\mingw810_64\\x86_64-w64-mingw32\\include\\winerror.h\u003c/code\u003eæ–‡ä»¶æœç´¢\u003ccode\u003eERROR_INCORRECT_SIZE __MSABI_LONG\u003c/code\u003e, æŸ¥çœ‹è¯¥å®šä¹‰ä¸‹é¢æ˜¯å¦æœ‰ä»¥ä¸‹å®šä¹‰, æ²¡æœ‰çš„è¯åŠ ä¸Š:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-c\" data-lang=\"c\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#define ERROR_SYMLINK_CLASS_DISABLED                       1463\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#define ERROR_SYMLINK_NOT_SUPPORTED                        1464\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#define ERROR_XML_PARSE_ERROR                              1465\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#define ERROR_XMLDSIG_ERROR                                1466\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#define ERROR_RESTART_APPLICATION                          1467\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#define ERROR_WRONG_COMPARTMENT                            1468\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#define ERROR_AUTHIP_FAILURE                               1469\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#define ERROR_NO_NVRAM_RESOURCES                           1470\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eä¸‹è½½å¹¶å®‰è£…cmake\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eä¸‹è½½å¹¶è§£å‹vtk-v9.1.0\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eè¿›å…¥vtk-v9.1.0ç›®å½•ä¸‹åˆ›å»ºbuildæ–‡ä»¶å¤¹\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eæ‰“å¼€cmake-guiå¯¹vtk-v9.1.0è¿›è¡Œé…ç½®\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eè®¾ç½®æºç å’Œç¼–è¯‘è·¯å¾„\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"./imgs/1.png\" alt=\"\"  /\u003e\n\u003c/p\u003e\n\u003cp\u003eç‚¹å‡»ConfigureæŒ‰é’®, é€‰æ‹©\u003ccode\u003eMinGW Makefiles\u003c/code\u003e, ç„¶åç‚¹å‡»Finish\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"./imgs/2.png\" alt=\"\"  /\u003e\n\u003c/p\u003e\n\u003cp\u003eéœ€è¦ç­‰å¾…CMakeè¿›è¡Œä¸€äº›é…ç½®, ç„¶åä¼šå‡ºç°ä¸€äº›æ–°çš„é€‰é¡¹, ä¸‹é¢æ˜¯ä¸€äº›æˆ‘ä»¬è¦é…ç½®çš„é€‰é¡¹, å…ˆé€‰ä¸­ç•Œé¢ä¸Šçš„Advancedå¤é€‰æ¡†:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eValue\u003c/th\u003e\n          \u003cth\u003eæè¿°\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCMAKE_CXX_FLAGS\u003c/td\u003e\n          \u003ctd\u003e-fcommon\u003c/td\u003e\n          \u003ctd\u003e-\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCMAKE_C_FLAGS\u003c/td\u003e\n          \u003ctd\u003e-fcommon\u003c/td\u003e\n          \u003ctd\u003e-\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCMAKE_BUILD_TYPE\u003c/td\u003e\n          \u003ctd\u003eRelease\u003c/td\u003e\n          \u003ctd\u003eä»¥Releaseçš„æ¨¡å¼è¿›è¡Œç¼–è¯‘\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCMAKE_INSTALL_PREFIX\u003c/td\u003e\n          \u003ctd\u003eC:\\Library\\VTK\u003c/td\u003e\n          \u003ctd\u003eæ‰§è¡Œmake installæ—¶çš„å®‰è£…è·¯å¾„\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eVTK_GROUP_ENABLE_Qt\u003c/td\u003e\n          \u003ctd\u003eYES\u003c/td\u003e\n          \u003ctd\u003eä½¿èƒ½Qté€‰é¡¹\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"./imgs/3.png\" alt=\"\"  /\u003e\n\u003c/p\u003e","title":"windowsç³»ç»Ÿvtk-v9.1.0ä½¿ç”¨Qt5.15.2è‡ªå¸¦mingw810_64è¿›è¡Œç¼–è¯‘"},{"content":"IsaacLabæœ¬åœ°å®‰è£…çš„æ–¹å¼æœ‰ä¸¤ç§\né€šè¿‡PIPå®‰è£…\näºŒè¿›åˆ¶å®‰è£…\næœ¬æ¬¡è¯¾ç¨‹å°†ä½¿ç”¨äºŒè¿›åˆ¶å®‰è£…\nå®‰è£…è¦æ±‚ ç³»ç»Ÿè¦æ±‚ Element Minimum Spec Good Ideal OS Ubuntu 20.04/22.04ã€Windows 10/11 Ubuntu 20.04/22.04ã€Windows 10/11 Ubuntu 20.04/22.04ã€Windows 10/11 CPU Intel Core i7 (7th Generation)ã€AMD Ryzen 5 Intel Core i7 (9th Generation)ã€AMD Ryzen 7 Intel Core i9, X-series or higherã€AMD Ryzen 9, Threadripper or higher Cores 4 8 16 RAM 32GB* 64GB* 64GB* Storage 50GB SSD 500GB SSD 1TB NVMe SSD GPU GeForce RTX 3070 GeForce RTX 4080 RTX Ada 6000 VRAM 8GB* 16GB* 48GB* æœ¬æœºé…ç½® æè¿° åœ°å€ æ˜¾å¡ RTX 3080 Ti æ“ä½œç³»ç»Ÿ PopOSï¼ˆä¸€æ¬¾åŸºäºUbuntuçš„æ“ä½œç³»ç»Ÿï¼‰ https://pop.system76.com IsaacSim 4.2.0 https://developer.nvidia.com/omniverse#section-getting-started IsaacLab æœ€æ–°çš„mainåˆ†æ”¯ https://github.com/isaac-sim/IsaacLab Anaconda Anaconda3-2024.10-1-Linux-x86_64 https://docs.anaconda.com/anaconda/install ğŸ‰ å¼€å§‹å®‰è£…ï¼ 1. Anacondaå®‰è£…ï¼ˆLinuxï¼‰ # å®‰è£…ä¾èµ– sudo apt-get install libgl1-mesa-glx libegl1-mesa libxrandr2 libxrandr2 libxss1 libxcursor1 libxcomposite1 libasound2 libxi6 libxtst6 # ä¸‹è½½ \u0026amp; å®‰è£…anaconda curl -O https://repo.anaconda.com/archive/Anaconda3-2024.10-1-Linux-x86_64.sh bash ~/Anaconda3-2024.10-1-Linux-x86_64.sh # åˆ·æ–°ç¯å¢ƒå˜é‡ source ~/.zshrc # æˆ–source ~/.bashrc 2. å®‰è£…Omniverse Launcher # ä¸‹è½½Omniverse Launcher wget https://install.launcher.omniverse.nvidia.com/installers/omniverse-launcher-linux.AppImage # æ·»åŠ å¯æ‰§è¡Œæƒé™ chmod +x omniverse-launcher-linux.AppImage # è¿è¡Œ ./omniverse-launcher-linux.AppImage è¿è¡Œåå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œç„¶åè¾“å…¥é‚®ç®±è´¦å·ç™»é™†ï¼ˆæ²¡æ³¨å†Œè¿‡çš„éœ€è¦å…ˆæ³¨å†Œï¼‰\nç™»é™†åéœ€è¦è¿›è¡Œè®¾ç½®ï¼Œè¿™é‡Œæ¨èç›´æ¥é»˜è®¤è®¾ç½®ï¼Œè¿™æ ·IsaacSimçš„é»˜è®¤å®‰è£…è·¯å¾„å°±åœ¨~/.local/share/ov/pkgä¸‹\n3. å®‰è£…IsaacSim4.2.0 åˆ°è¿™é‡Œï¼ŒOmniverse Launcherå°±å·²ç»å®‰è£…å’Œé…ç½®å®Œæˆäº†ï¼Œå¯ä»¥é€šè¿‡Omniverse Launcherç›´æ¥å®‰è£…IsaacSim4.2.0\né€‰æ‹©EXCHANGE-\u0026gt;APPSï¼Œç„¶åç‚¹å‡»ISAAC SIM\nç„¶åç‚¹å‡»INSTALLå¼€å§‹å®‰è£…\nç­‰å¾…å®‰è£…å®Œæˆåï¼Œç‚¹å‡»LAUNCHæ¥å¯åŠ¨IsaacSimï¼Œçœ‹çœ‹èƒ½å¦æ­£å¸¸è¿è¡Œ\nç¬¬ä¸€æ¬¡è¿è¡Œæ—¶å¯èƒ½ä¼šå¼¹å‡ºå‡ ä¸ªå¼¹çª—ï¼Œç›´æ¥ç‚¹å‡»OKæˆ–è€…ç¡®å®šå°±è¡Œï¼Œä¸‹æ¬¡å¯åŠ¨åº”è¯¥å°±æ²¡æœ‰äº†\nç‚¹å‡»STARTå¯åŠ¨IsaacSim\nçœ‹åˆ°è¿™ä¸ªç•Œé¢ï¼Œé‚£è¯æ˜IsaacSimå®‰è£…æˆåŠŸå¹¶èƒ½å¤Ÿæ­£å¸¸è¿è¡Œäº†ï¼\n4. â˜•ï¸ æ­£ç‰‡å¼€å§‹ï¼å®‰è£…IsaacLab 4.1 é…ç½®IsaacSimç¯å¢ƒå˜é‡ isaac simé»˜è®¤è¢«å®‰è£…åœ¨${HOME}/.local/share/ov/pkg/isaac_sim-*è·¯å¾„ä¸‹ã€‚\nåœ¨~/.bashrcæˆ–~/.zshrcæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹\n# Isaac Sim æ ¹ç›®å½• export ISAACSIM_PATH=\u0026#34;${HOME}/.local/share/ov/pkg/isaac-sim-4.2.0\u0026#34; # Isaac Sim python å¯æ‰§è¡Œç¨‹åº export ISAACSIM_PYTHON_EXE=\u0026#34;${ISAACSIM_PATH}/python.sh\u0026#34; source ~/.bashrcæˆ–source ~/.zshrcæ›´æ–°ç¯å¢ƒå˜é‡\n4.2 å…‹éš†IsaacLabé¡¹ç›® # åˆ‡æ¢åˆ°isaac-simæ‰€åœ¨ç›®å½• cd ~/.local/share/ov/pkg # å°†isaaclabå…‹éš†åˆ°isaac-simçš„åŒçº§ç›®å½• git clone git@github.com:isaac-sim/IsaacLab.git # è¿›å…¥IsaacLabç›®å½• cd IsaacLab âš ï¸æ‰“å¼€./isaaclab.shæ–‡ä»¶ï¼Œåœ¨ISAACLAB_PATHå˜é‡ä¸Šæ–¹æ·»åŠ candaç¯å¢ƒåˆå§‹åŒ–ä»£ç \nsource ~/.local/share/ov/pkg/isaac-sim-4.2.0/setup_conda_env.sh # get source directory export ISAACLAB_PATH=\u0026#34;$( cd \u0026#34;$( dirname \u0026#34;${BASH_SOURCE[0]}\u0026#34; )\u0026#34; \u0026amp;\u0026gt; /dev/null \u0026amp;\u0026amp; pwd )\u0026#34; 4.3 åœ¨IsaacLabåˆ›å»ºIsaacSimçš„ç¬¦å·é“¾æ¥ ln -s ~/.local/share/ov/pkg/isaac-sim-4.2.0 _isaac_sim 4.4 é…ç½®condaç¯å¢ƒ æœ¬æ•™ç¨‹çš„ç¬¬ä¸€éƒ¨å°±å·²ç»æŠŠcondaå®‰è£…å®Œæˆäº†ï¼Œä¸‹é¢çš„æŒ‡ä»¤ä¼šåœ¨condaä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºisaaclabçš„æ–°ç¯å¢ƒï¼ˆå½“å‰åœ¨IsaacLabç›®å½•ä¸‹ï¼‰\n./isaaclab.sh --conda æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æŒ‡ä»¤æ¿€æ´»isaaclabçš„ç¯å¢ƒï¼Œæ¿€æ´»ç¯å¢ƒåæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸IsaacSimæ†ç»‘åœ¨ä¸€èµ·çš„pythonè€Œæ— éœ€ä½¿ç”¨./isaaclab.sh -pæ¥è¿è¡Œpythonè„šæœ¬ï¼Œç›´æ¥åœ¨ç¯å¢ƒä¸­ä½¿ç”¨pythonæŒ‡ä»¤å³å¯ã€‚\nconda activate isaaclab 4.5 å®‰è£…æ‰©å±• æœ¬æ•™ç¨‹æŠŠæ‰€æœ‰æ‰©å±•éƒ½å®‰è£…äº†ï¼Œæ–¹é¢åç»­æµ‹è¯•ä¸åŒçš„å¼ºåŒ–å­¦ä¹ æ¡†æ¶\n# å®‰è£…ä¾èµ– sudo apt install cmake build-essential # å‡çº§pip python3 -m pip install --upgrade pip # éå†source/extensionsç›®å½•ä¸‹æ‰€æœ‰çš„æ‰©å±•å¹¶å®‰è£…å®ƒä»¬ ./isaaclab.sh -i âš ï¸å¦‚æœåœ¨æ‰§è¡Œ./isaaclab.sh -iæŠ¥è·Ÿè·¯å¾„ç›¸å…³çš„é”™è¯¯ï¼Œè¯·æŠŠ./isaaclab.shä¸­çš„ISAACLAB_PATHå˜é‡æ³¨é‡Šæ‰ï¼Œç„¶åå†æ¬¡è¿è¡Œ./isaaclab.sh -i\nsource ~/.local/share/ov/pkg/isaac-sim-4.2.0/setup_conda_env.sh # get source directory # export ISAACLAB_PATH=\u0026#34;$( cd \u0026#34;$( dirname \u0026#34;${BASH_SOURCE[0]}\u0026#34; )\u0026#34; \u0026amp;\u0026gt; /dev/null \u0026amp;\u0026amp; pwd )\u0026#34; 5. ğŸ¤– è®­ç»ƒç¬¬ä¸€ä¸ªæ¨¡å‹ # ä½¿ç”¨rl_gamesè®­ç»ƒHumanoid-v0æ¨¡å‹ ./isaaclab.sh -p source/standalone/workflows/rl_games/train.py --task=Isaac-Humanoid-v0 --headless # æ¼”ç¤ºæ¨¡å‹ ./isaaclab.sh -p source/standalone/workflows/rl_games/play.py --task=Isaac-Humanoid-v0 --num_envs 32 --checkpoint /PATH/TO/model.pth åœ¨æ¼”ç¤ºæ¨¡å‹æ—¶éœ€è¦å°†æŒ‡ä»¤ä¸­çš„PATHæ›¿æ¢ä¸ºå®é™…æ¨¡å‹ä¿å­˜çš„è·¯å¾„ã€‚\n","permalink":"https://fake-rick.github.io/posts/%E9%85%8D%E7%BD%AEisaaclab%E7%8E%AF%E5%A2%83/","summary":"\u003cp\u003e\u003cstrong\u003eIsaacLabæœ¬åœ°å®‰è£…çš„æ–¹å¼æœ‰ä¸¤ç§\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eé€šè¿‡PIPå®‰è£…\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eäºŒè¿›åˆ¶å®‰è£…\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eæœ¬æ¬¡è¯¾ç¨‹å°†ä½¿ç”¨äºŒè¿›åˆ¶å®‰è£…\u003c/p\u003e\n\u003ch2 id=\"å®‰è£…è¦æ±‚\"\u003eå®‰è£…è¦æ±‚\u003c/h2\u003e\n\u003ch2 id=\"ç³»ç»Ÿè¦æ±‚\"\u003eç³»ç»Ÿè¦æ±‚\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eElement\u003c/th\u003e\n          \u003cth\u003eMinimum Spec\u003c/th\u003e\n          \u003cth\u003eGood\u003c/th\u003e\n          \u003cth\u003eIdeal\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eOS\u003c/td\u003e\n          \u003ctd\u003eUbuntu 20.04/22.04ã€Windows 10/11\u003c/td\u003e\n          \u003ctd\u003eUbuntu 20.04/22.04ã€Windows 10/11\u003c/td\u003e\n          \u003ctd\u003eUbuntu 20.04/22.04ã€Windows 10/11\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCPU\u003c/td\u003e\n          \u003ctd\u003eIntel Core i7 (7th Generation)ã€AMD Ryzen 5\u003c/td\u003e\n          \u003ctd\u003eIntel Core i7 (9th Generation)ã€AMD Ryzen 7\u003c/td\u003e\n          \u003ctd\u003eIntel Core i9, X-series or higherã€AMD Ryzen 9, Threadripper or higher\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCores\u003c/td\u003e\n          \u003ctd\u003e4\u003c/td\u003e\n          \u003ctd\u003e8\u003c/td\u003e\n          \u003ctd\u003e16\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eRAM\u003c/td\u003e\n          \u003ctd\u003e32GB*\u003c/td\u003e\n          \u003ctd\u003e64GB*\u003c/td\u003e\n          \u003ctd\u003e64GB*\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eStorage\u003c/td\u003e\n          \u003ctd\u003e50GB SSD\u003c/td\u003e\n          \u003ctd\u003e500GB SSD\u003c/td\u003e\n          \u003ctd\u003e1TB NVMe SSD\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eGPU\u003c/td\u003e\n          \u003ctd\u003eGeForce RTX 3070\u003c/td\u003e\n          \u003ctd\u003eGeForce RTX 4080\u003c/td\u003e\n          \u003ctd\u003eRTX Ada 6000\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eVRAM\u003c/td\u003e\n          \u003ctd\u003e8GB*\u003c/td\u003e\n          \u003ctd\u003e16GB*\u003c/td\u003e\n          \u003ctd\u003e48GB*\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"æœ¬æœºé…ç½®\"\u003eæœ¬æœºé…ç½®\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e\u003c/th\u003e\n          \u003cth\u003eæè¿°\u003c/th\u003e\n          \u003cth\u003eåœ°å€\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eæ˜¾å¡\u003c/td\u003e\n          \u003ctd\u003eRTX 3080 Ti\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eæ“ä½œç³»ç»Ÿ\u003c/td\u003e\n          \u003ctd\u003ePopOSï¼ˆä¸€æ¬¾åŸºäºUbuntuçš„æ“ä½œç³»ç»Ÿï¼‰\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://pop.system76.com\"\u003ehttps://pop.system76.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eIsaacSim\u003c/td\u003e\n          \u003ctd\u003e4.2.0\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://developer.nvidia.com/omniverse#section-getting-started\"\u003ehttps://developer.nvidia.com/omniverse#section-getting-started\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eIsaacLab\u003c/td\u003e\n          \u003ctd\u003eæœ€æ–°çš„mainåˆ†æ”¯\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/isaac-sim/IsaacLab\"\u003ehttps://github.com/isaac-sim/IsaacLab\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnaconda\u003c/td\u003e\n          \u003ctd\u003eAnaconda3-2024.10-1-Linux-x86_64\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://docs.anaconda.com/anaconda/install\"\u003ehttps://docs.anaconda.com/anaconda/install\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"-å¼€å§‹å®‰è£…\"\u003eğŸ‰ å¼€å§‹å®‰è£…ï¼\u003c/h2\u003e\n\u003ch3 id=\"1-anacondaå®‰è£…linux\"\u003e1. Anacondaå®‰è£…ï¼ˆLinuxï¼‰\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# å®‰è£…ä¾èµ–\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt-get install libgl1-mesa-glx libegl1-mesa libxrandr2 libxrandr2 libxss1 libxcursor1 libxcomposite1 libasound2 libxi6 libxtst6\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ä¸‹è½½ \u0026amp; å®‰è£…anaconda\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl -O https://repo.anaconda.com/archive/Anaconda3-2024.10-1-Linux-x86_64.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebash ~/Anaconda3-2024.10-1-Linux-x86_64.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# åˆ·æ–°ç¯å¢ƒå˜é‡\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esource ~/.zshrc \u003cspan style=\"color:#75715e\"\u003e# æˆ–source ~/.bashrc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-å®‰è£…omniverse-launcher\"\u003e2. å®‰è£…Omniverse Launcher\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ä¸‹è½½Omniverse Launcher\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget https://install.launcher.omniverse.nvidia.com/installers/omniverse-launcher-linux.AppImage\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# æ·»åŠ å¯æ‰§è¡Œæƒé™\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e chmod +x omniverse-launcher-linux.AppImage\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# è¿è¡Œ\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./omniverse-launcher-linux.AppImage\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè¿è¡Œåå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œç„¶åè¾“å…¥é‚®ç®±è´¦å·ç™»é™†ï¼ˆæ²¡æ³¨å†Œè¿‡çš„éœ€è¦å…ˆæ³¨å†Œï¼‰\u003c/p\u003e","title":"é…ç½®IsaacLabç¯å¢ƒ"},{"content":" å…ˆé…ç½®Rustå¼€å‘STM32æ‰€éœ€çš„ç¯å¢ƒï¼Œæ–‡ç« åœ°å€ï¼š https://fake-rick.github.io/posts/rust%E9%85%8D%E7%BD%AEstm32%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/\nå®‰è£…é¡¹ç›®åˆ›å»ºCLIå·¥å…· cargo install cargo-embassy\nç”Ÿæˆé¡¹ç›® cargo embassy init my_project --chip stm32f407vgtx\nåœ¨Cargo.tomlä¸­[dependencies]æ·»åŠ ï¼š\nembassy-stm32 = { version = \u0026#34;0.1.0\u0026#34;, features = [\u0026#34;defmt\u0026#34;, \u0026#34;stm32f407vg\u0026#34;, \u0026#34;unstable-pac\u0026#34;, \u0026#34;memory-x\u0026#34;, \u0026#34;time-driver-any\u0026#34;, \u0026#34;exti\u0026#34;, \u0026#34;chrono\u0026#34;] } Embed.tomlæ–‡ä»¶ # This file was automatically generated. [default.general] chip = \u0026#34;STM32F407VGTx\u0026#34; [default.reset] halt_afterwards = false [default.rtt] enabled = true [default.gdb] enabled = false è¿è¡Œ cargo run å¦‚æœåœ¨ç»ˆç«¯å‡ºç°ä»¥ä¸‹å†…å®¹åˆ™è¡¨ç¤ºè¿è¡ŒæˆåŠŸï¼š\n","permalink":"https://fake-rick.github.io/posts/rust%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91embassy%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","summary":"\u003cul\u003e\n\u003cli\u003eå…ˆé…ç½®Rustå¼€å‘STM32æ‰€éœ€çš„ç¯å¢ƒï¼Œæ–‡ç« åœ°å€ï¼š\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca href=\"https://fake-rick.github.io/posts/rust%E9%85%8D%E7%BD%AEstm32%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/\"\u003ehttps://fake-rick.github.io/posts/rust%E9%85%8D%E7%BD%AEstm32%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"å®‰è£…é¡¹ç›®åˆ›å»ºcliå·¥å…·\"\u003eå®‰è£…é¡¹ç›®åˆ›å»ºCLIå·¥å…·\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ecargo install cargo-embassy\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"ç”Ÿæˆé¡¹ç›®\"\u003eç”Ÿæˆé¡¹ç›®\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ecargo embassy init my_project --chip stm32f407vgtx\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eåœ¨Cargo.tomlä¸­[dependencies]æ·»åŠ ï¼š\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eembassy-stm32 = { version = \u0026#34;0.1.0\u0026#34;, features = [\u0026#34;defmt\u0026#34;, \u0026#34;stm32f407vg\u0026#34;, \u0026#34;unstable-pac\u0026#34;, \u0026#34;memory-x\u0026#34;, \u0026#34;time-driver-any\u0026#34;, \u0026#34;exti\u0026#34;, \u0026#34;chrono\u0026#34;] }\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"embedtomlæ–‡ä»¶\"\u003eEmbed.tomlæ–‡ä»¶\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# This file was automatically generated.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003edefault.general\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003echip \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;STM32F407VGTx\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003edefault.reset\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehalt_afterwards \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003edefault.rtt\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eenabled \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003edefault.gdb\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eenabled \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e false\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"è¿è¡Œ\"\u003eè¿è¡Œ\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecargo run\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå¦‚æœåœ¨ç»ˆç«¯å‡ºç°ä»¥ä¸‹å†…å®¹åˆ™è¡¨ç¤ºè¿è¡ŒæˆåŠŸï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"./imgs/A.png\" alt=\"\"  /\u003e\n\u003c/p\u003e","title":"RuståµŒå…¥å¼å¼€å‘embassyç¯å¢ƒæ­å»º"},{"content":"å®‰è£… å®‰è£…cargoå·¥å…· cargo install cargo-generate\nå®‰è£…stlink v2é©±åŠ¨ sudo apt-get install git make cmake libusb-1.0-0-dev sudo apt-get install gcc build-essential git clone https://github.com/stlink-org/stlink.git cd stlink/ mkdir build cd build cmake .. make cd bin/ sudo cp st-* /usr/local/bin cd ../lib/ sudo cp *.so* /lib32 cd ../../ sudo cp config/udev/rules.d/49-stlinkv* /etc/udev/rules.d/ å®‰è£…çƒ§å½•å’Œè°ƒè¯•çš„å·¥å…· Linux, macOS curl --proto '=https' --tlsv1.2 -LsSf https://github.com/probe-rs/probe-rs/releases/latest/download/probe-rs-tools-installer.sh | sh\nWIndows irm https://github.com/probe-rs/probe-rs/releases/latest/download/probe-rs-tools-installer.ps1 | iex\nå®‰è£…é€‚ç”¨äºARM Cortex-Mç›®æ ‡çš„rust-stdç»„ä»¶ rustup target add thumbv6m-none-eabi thumbv7m-none-eabi thumbv7em-none-eabi thumbv7em-none-eabihf\nåˆ›å»ºå·¥ç¨‹ cargo generate --git https://github.com/burrbull/stm32-template/\nè¾“å…¥é¡¹ç›®ç›¸å…³ä¿¡æ¯ æ ¹æ®è‡ªå·±çš„éœ€æ±‚å’ŒèŠ¯ç‰‡å‹å·è¿›è¡Œå¡«å†™\nå­—æ®µ å€¼ Project Name simple-stm32f4 What HAL version to use? last-release Is it RTIC-based application? false Will this program use defmt logger? false What microcontroller name? stm32f407vgt6 ç¼–è¯‘å·¥ç¨‹å¹¶çƒ§å½• è¿›å…¥é¡¹ç›®ç›®å½•\ncd simple-stm32f4\næ‰§è¡Œç¼–è¯‘\u0026amp;çƒ§å½•å‘½ä»¤ï¼š\ncargo-flash --release --chip STM32F407VGTx\nå¦‚æœçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºåˆ™è¡¨ç¤ºç¼–è¯‘çƒ§å½•éƒ½æ­£å¸¸äº†\nå…¶ä»–é…ç½® å¦‚æœåœ¨å¯åŠ¨ä¸²å£æ—¶æç¤ºæƒé™ä¸è¶³ï¼Œå¯ä»¥å°†å½“å‰ç”¨æˆ·æ·»åŠ åˆ°dialoutç”¨æˆ·ç»„ä¸­ï¼Œç„¶åé‡å¯ç”µè„‘ï¼š\nsudo usermod -a -G dialout username å®‰è£…JLInk\nsudo apt-get -y install libjaylink-dev ","permalink":"https://fake-rick.github.io/posts/rust%E9%85%8D%E7%BD%AEstm32%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/","summary":"\u003ch2 id=\"å®‰è£…\"\u003eå®‰è£…\u003c/h2\u003e\n\u003ch3 id=\"å®‰è£…cargoå·¥å…·\"\u003eå®‰è£…cargoå·¥å…·\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ecargo install cargo-generate\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"å®‰è£…stlink-v2é©±åŠ¨\"\u003eå®‰è£…stlink v2é©±åŠ¨\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt-get install git make cmake libusb-1.0-0-dev\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt-get install gcc build-essential\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit clone https://github.com/stlink-org/stlink.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd stlink/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecmake ..\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd bin/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo cp st-* /usr/local/bin\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd ../lib/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo cp *.so* /lib32\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd ../../\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo cp config/udev/rules.d/49-stlinkv* /etc/udev/rules.d/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"å®‰è£…çƒ§å½•å’Œè°ƒè¯•çš„å·¥å…·\"\u003eå®‰è£…çƒ§å½•å’Œè°ƒè¯•çš„å·¥å…·\u003c/h3\u003e\n\u003ch4 id=\"linux-macos\"\u003eLinux, macOS\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003ecurl --proto '=https' --tlsv1.2 -LsSf https://github.com/probe-rs/probe-rs/releases/latest/download/probe-rs-tools-installer.sh | sh\u003c/code\u003e\u003c/p\u003e\n\u003ch4 id=\"windows\"\u003eWIndows\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003eirm https://github.com/probe-rs/probe-rs/releases/latest/download/probe-rs-tools-installer.ps1 | iex\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"å®‰è£…é€‚ç”¨äºarm-cortex-mç›®æ ‡çš„rust-stdç»„ä»¶\"\u003eå®‰è£…é€‚ç”¨äºARM Cortex-Mç›®æ ‡çš„rust-stdç»„ä»¶\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003erustup target add thumbv6m-none-eabi thumbv7m-none-eabi thumbv7em-none-eabi thumbv7em-none-eabihf\u003c/code\u003e\u003c/p\u003e","title":"Rusté…ç½®STM32åµŒå…¥å¼å¼€å‘ç¯å¢ƒ"},{"content":"åŸæ–‡åœ°å€ï¼šhttps://isaac-sim.github.io/IsaacLab/source/tutorials/03_envs/create_direct_rl_env.html\nä»ç¯å¢ƒä¸­è·å–ä¿¡æ¯ï¼ˆè§‚å¯Ÿï¼‰ è·å–jointï¼ˆé“°é“¾ï¼‰ä¿¡æ¯ï¼šä½ç½®å’Œé€Ÿåº¦ jointä¼šè¢«åŒ…å«åœ¨Articulationï¼ˆå…³èŠ‚ï¼‰ä¸­ï¼Œä¸€ä¸ªArticulationå¯èƒ½ä¼šåŒ…å«1ä¸ªæˆ–å¤šä¸ªçš„jointå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡Articulation.find_joints()æ–¹æ³•è·å¾—jointåœ¨å½“å‰Articulationä¸­çš„ç´¢å¼•ï¼ˆindexï¼‰æ•°æ®ã€‚\nfind_jointsçš„è¿”å›å€¼æ˜¯è¿™æ ·çš„ï¼štuple[list[jointç´¢å¼•], list[jointåå­—]]\nfind_jointsçš„å‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š\ndef find_joints( self, name_keys: str | Sequence[str], joint_subset: list[str] | None = None, preserve_order: bool = False ) -\u0026gt; tuple[list[int], list[str]] åœ¨Articulationå†…éƒ¨æœ‰ä¸€ä¸ªå±æ€§ç§æœ‰å˜é‡_data: ArticulationDataï¼Œè¯¥å˜é‡é€šè¿‡æ–¹æ³•def data(self) -\u0026gt; ArticulationDataè·å–ï¼Œåœ¨ArticulationDataä¸­å­˜æ”¾ç€å‡ ä¸ªå…³èŠ‚é‡è¦çš„æ•°æ®ï¼šä½ç½®ArticulationData._joint_posï¼Œé€Ÿåº¦ArticulationData._joint_velï¼ŒåŠ é€Ÿåº¦ArticulationData._joint_acc\nåœ¨ArticulationDataæœ‰å‡ ä¸ª@propertyè£…é¥°å™¨å‡½æ•°ï¼Œç”¨äºè·å–ä¸Šè¿°çš„ä¸‰ä¸ªå±æ€§ï¼Œè¿™æ ·å¯ä»¥ç”¨è¿‡å±æ€§åçš„æ–¹å¼ç›´æ¥è®¿é—®åˆ°è¿™äº›æ•°æ®ã€‚\nä¸‹é¢ä»‹ç»ä¸‹è¿™ä¸‰ä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼š\njoint_posè¿”å›torch.Size([num_instances, num_joints])\njoint_velè¿”å›torch.Size([num_instances, num_joints])\njoint_accè¿”å›torch.Size([num_instances, num_joints])\næ˜¯æ—¶å€™è®²è§£ä¸‹DirectRLEnv(gym.Env)._get_observations(self) -\u0026gt; VecEnvObsæ–¹æ³•äº†ï¼Œè¯¥æ–¹æ³•å¸¦æœ‰@abstractmethodè¢«å®šä¹‰æˆæŠ½è±¡æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç»§æ‰¿DirectRLEnvç±»åå¿…é¡»åœ¨è‡ªå·±çš„ç±»ä¸­å®ç°_get_observationsæ–¹æ³•ã€‚\næˆ‘ä»¬åœ¨_get_observationsæ–¹æ³•ä¸­è®¡ç®—å¹¶è¿”å›è§‚æµ‹å€¼ï¼Œè¿™ä¼šç”¨åˆ°ä¸Šé¢æåˆ°çš„ArticulationDataä»¥åŠå¦‚ä½•é€šè¿‡jointç´¢å¼•ä»ä¸­è·å–å®é™…æ•°æ®ã€‚\nåœ¨cartpole_env.pyçš„ä»£ç ä¸­æœ‰å¦‚ä¸‹å®ç°ï¼š\ndef _get_observations(self) -\u0026gt; torch.Dict[str, torch.Tensor | torch.Dict[str, torch.Tensor]]: obs = torch.cat( ( self.joint_pos[:, self._pole_dof_idx[0]].unsqueeze(dim=1), self.joint_vel[:, self._pole_dof_idx[0]].unsqueeze(dim=1), self.joint_pos[:, self._cart_dof_idx[0]].unsqueeze(dim=1), self.joint_vel[:, self._cart_dof_idx[0]].unsqueeze(dim=1), ), dim=-1, ) observations = {\u0026#34;policy\u0026#34;: obs} return observations ä¸Šè¿°ä»£ç ä¸­çš„_pole_dof_idxé‡Œè¾¹å­˜æ”¾çš„æ˜¯æ†å­çš„jointå¯¹åº”çš„ç´¢å¼•æ•°æ®ï¼Œ_cart_dof_idxå­˜æ”¾çš„æ˜¯å°è½¦çš„jointå¯¹åº”çš„ç´¢å¼•æ•°æ®ï¼Œè¿™é‡Œä»‹ç»ä¸‹è·å–æ†å­ä½ç½®çš„ä»£ç ï¼Œè·å–æ†å­é€Ÿåº¦å’Œå°è½¦ä½ç½®å’Œé€Ÿåº¦çš„ä»£ç éƒ½ä¸€æ ·ã€‚\nself.joint_poså°±çš„è¿”å›æ•°æ®ç±»å‹æ˜¯:torch.Size([num_instances, num_joints])å½¢çŠ¶çš„å¼ é‡ï¼Œæ‰€ä»¥self.joint_pos[:, self._pole_dof_idx[0]]çš„æ„æ€å°±æ˜¯ä»self.joint_posä¸­è·å–ç´¢å¼•ä¸ºself._pole_dof_idx[0]çš„æ‰€æœ‰æ†å­çš„ä½ç½®ä¿¡æ¯\né€šè¿‡åœ¨_get_observationså‡½æ•°ä¸­å¢åŠ äº†printå‡½æ•°æˆ‘æŠŠæ•°æ®æ‰“å°å‡ºæ¥\nprint(\u0026#34;[INFO]: _pole_dof_idx -\u0026gt; \u0026#34;, self._pole_dof_idx) print(\u0026#34;[INFO]: joint_pos -\u0026gt; \u0026#34;, self.joint_pos) print(\u0026#34;[INFO]: pole_joint_pos -\u0026gt; \u0026#34;, self.joint_pos[:, self._pole_dof_idx[0]]) æ‰“å°å‡ºçš„æ•°æ®å¦‚ä¸‹ï¼š\n[INFO]: _pole_dof_idx -\u0026gt; [1] [INFO]: joint_pos -\u0026gt; tensor([[-0.0995, -0.0243], [-0.5815, 0.0256], [-0.5531, 0.4727], ..., [ 0.4905, -0.7841], [-0.4129, 0.4739], [ 0.4791, -0.8703]], device=\u0026#39;cuda:0\u0026#39;) [INFO]: pole_joint_pos -\u0026gt; tensor([-0.0243, 0.0256, 0.4727, ..., -0.7841, 0.4739, -0.8703], device=\u0026#39;cuda:0\u0026#39;) ç”±äºself._pole_dof_idx[0] == 1ï¼Œæ‰€ä»¥ç¬¬äºŒåˆ—çš„æ•°æ®å­˜å‚¨çš„å°±æ˜¯æ†å­çš„ä½ç½®æ•°æ®äº†ã€‚ä½äºä»£ç ä¸­ç”¨äº†self._pole_dof_idx[0]ï¼Œå› ä¸ºself._pole_dof_idxçš„è¡¨ä¸­åªå­˜å‚¨äº†ä¸€ä¸ªjointçš„ç´¢å¼•å€¼ï¼Œä¹Ÿå°±æ˜¯å½“å‰æ†å­å¯¹åº”çš„jointç´¢å¼•å€¼ã€‚\nå¦‚æœå¤§å®¶æ„Ÿå…´è¶£çš„è¯å¯ä»¥æŠŠå°è½¦çš„æ•°æ®ä¹Ÿæ‰“å°å‡ºæ¥çœ‹ä¸‹åœ¨joint_posä¸­çš„ç¬¬ä¸€åˆ—æ•°æ®æ˜¯å¦æ˜¯å°è½¦çš„ä½ç½®ä¿¡æ¯ã€‚\nPytorchè¡¥å……ï¼š torch.unsqueeze(_input_,Â _dim_)å‡½æ•°\nç”¨æ¥å°†_input_çš„æ•°æ®å¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œä»¥æ‰“å°ä¿¡æ¯çš„pole_joint_posæ•°æ®ä¸ºä¾‹ï¼Œå½“dim=1æ—¶ï¼Œä¸€ç»´æ•°ç»„ä¼šå˜æˆäºŒç»´å¼ é‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\ntensor([[-0.0243], [0.0256], [0.4727], ..., [-0.7841], [0.4739], [-0.8703]], device=\u0026#39;cuda:0\u0026#39;) æ•°æ®å˜æˆäº†torch.Size([N, 1])ï¼Œä¹Ÿå°±æ˜¯Nè¡Œä¸€åˆ—çš„æ•°æ®\ntorch.cat(_tensors_,Â _dim=0_,Â _*_,Â _out=None_)Â â†’Â [Tensor]å‡½æ•°\nç”¨æ¥æŒ‰ç…§æŒ‡å®šç»´åº¦æ‹¼æ¥å¤šä¸ªå¼ é‡ï¼Œåœ¨æœ¬ä¾‹ä¸­torch.catçš„dim=-1ï¼Œæ‰€ä»¥æŒ‰ç…§å¼ é‡çš„æœ€åä¸€ä¸ªç»´åº¦è¿›è¡Œæ‹¼æ¥\næœ€ç»ˆ_get_observationsä¸­çš„obså˜é‡å­˜å‚¨è¿™ä¸€ä¸ªtorch.Size([N, 4])å½¢çŠ¶çš„å¼ é‡æ•°æ®ï¼š\næ†å­ä½ç½® æ†å­é€Ÿåº¦ å°è½¦ä½ç½® å°è½¦é€Ÿåº¦ \u0026hellip; \u0026hellip; \u0026hellip; \u0026hellip; å¥–åŠ±å‡½æ•° _get_rewards åˆ†æ å­˜æ´»å¥–åŠ±rew_alive åœ¨ç±»class DirectRLEnv(gym.Env)ä¸­æœ‰ä»¥ä¸‹å˜é‡ self.reset_terminated = torch.zeros(self.num_envs, device=self.device, dtype=torch.bool)\nå½“é‡ç½®æ—¶è¯¥å˜é‡è¢«è®¾ç½®ä¸ºtrue, å¦åˆ™ä¸ºfalse\nåœ¨è®¡ç®—å­˜æ´»å¥–åŠ±ï¼šrew_aliveæ—¶çš„ä»£ç å¦‚ä¸‹ï¼šrew_alive = rew_scale_alive * (1.0 - reset_terminated.float())\nå°†torch.boolå¼ºè½¬ä¸ºtorch.floatç±»å‹ï¼Œå½“é‡ç½®å‘ç”Ÿæ—¶rew_scale_alive * ï¼ˆ1.0 - 1.0ï¼‰ï¼Œæ‰€ä»¥é‡ç½®æ—¶çš„å­˜æ´»å¥–åŠ±å°±æ˜¯0\nç»ˆæ­¢å¥–åŠ±ï¼ˆæƒ©ç½šï¼‰rew_termination å½“ä»£ç†ä¸ç¨³å®šæˆ–å¤„äºä¸å®‰å…¨çš„çŠ¶æ€æ—¶è§¦å‘ï¼Œå¦å¤–å¦‚æœä»£ç†èƒ½å¤Ÿé•¿æ—¶é—´ç¨³å®šè¿è¡Œä¹Ÿä¼šå¸Œæœ›ç»ˆæ­¢å›åˆå¹¶å¼€å§‹æ–°çš„å›åˆï¼Œè¿™æ ·ä»£ç†å¯ä»¥å­¦ä¼šä»ä¸åŒçš„èµ·å§‹é…ç½®å¯åŠ¨\næ‰€ä»¥ç»ˆæ­¢åˆ†ä¸¤ç§ï¼š\næ—¶é—´é™åˆ¶æ¡ä»¶ ç»ˆæ­¢æ¡ä»¶ è®¡ç®—ç»ˆæ­¢å¥–åŠ±çš„ä»£ç å¦‚ä¸‹ï¼š\nrew_termination = rew_scale_terminated * reset_terminated.float()\né€Ÿåº¦ \u0026amp; ä½ç½® èŒƒå›´é™åˆ¶å¥–åŠ± å½“å°è½¦ä¸å€’ç«‹æ‘†çš„é€Ÿåº¦ä¸ä½ç½®åœ¨èŒƒå›´å†…æ—¶èƒ½å¤Ÿè·å¾—çš„å¥–åŠ±\nç›¸å…³çš„å¥–åŠ±æœ‰ä¸‰ä¸ªï¼Œçœ‹ä¸‹é¢çš„ä»£ç ï¼š\nrew_pole_pos = rew_scale_pole_pos * torch.sum(torch.square(pole_pos), dim=-1) rew_cart_vel = rew_scale_cart_vel * torch.sum(torch.abs(cart_vel), dim=-1) rew_pole_vel = rew_scale_pole_vel * torch.sum(torch.abs(pole_vel), dim=-1) Pytorchè¡¥å……ï¼š torch.sumå‡½æ•°ï¼š\nè¿”å›è¾“å…¥å¼ é‡ä¸­æ‰€æœ‰å…ƒç´ çš„æ€»å’Œï¼Œdim=-1è¡¨ç¤ºçš„æ˜¯æœ€åä¸€ä¸ªç»´åº¦\ntorch.squareå‡½æ•°ï¼š\nè®¡ç®—æ‰€æœ‰å…ƒç´ çš„å¹³æ–¹å€¼ï¼Œå¹¶è¿”å›æ–°å€¼çš„å¼ é‡\ntorch.abså‡½æ•°ï¼š\nè®¡ç®—æ‰€æœ‰å…ƒç´ çš„ç»å¯¹å€¼ï¼Œå¹¶è¿”å›æ–°å€¼çš„å¼ é‡\nè®¾è®¡ç»ˆæ­¢æ¡ä»¶_get_dones åœ¨è¶…æ—¶æˆ–è€…è¶…å‡ºèŒƒå›´æ—¶æˆ‘ä»¬éœ€è¦é‡ç½®ç¯å¢ƒï¼Œåœ¨DirectRLEnvä¸­æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ç”¨äºé…ç½®ç»ˆæ­¢æ¡ä»¶ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸¤ä¸ªTensorç»„æˆçš„Tupleã€‚Tupleä¸­çš„ç¬¬ä¸€ä¸ªTensorå­˜å‚¨äº†ç»ˆæ­¢æ¡ä»¶ï¼Œç¬¬äºŒä¸ªTensorå­˜å‚¨äº†è¶…æ—¶ä¿¡æ¯ï¼Œæ¯ä¸ªå¼ é‡çš„å½¢çŠ¶ä¸ºï¼štorch.Size([num_envs])\n@abstractmethod def _get_dones(self) -\u0026gt; tuple[torch.Tensor, torch.Tensor] åœ¨cartpole_env.pyä¸­çš„å®ç°å¦‚ä¸‹ï¼š\ndef _get_dones(self) -\u0026gt; tuple[torch.Tensor, torch.Tensor]: self.joint_pos = self.cartpole.data.joint_pos self.joint_vel = self.cartpole.data.joint_vel time_out = self.episode_length_buf \u0026gt;= self.max_episode_length - 1 out_of_bounds = torch.any(torch.abs(self.joint_pos[:, self._cart_dof_idx]) \u0026gt; self.cfg.max_cart_pos, dim=1) out_of_bounds = out_of_bounds | torch.any(torch.abs(self.joint_pos[:, self._pole_dof_idx]) \u0026gt; math.pi / 2, dim=1) return out_of_bounds, time_out è¶…æ—¶æ¡ä»¶(time_out)è®¡ç®— å°†å½“å‰æ‰€æœ‰ç¯å¢ƒçš„episodeç¼“å†²é•¿åº¦ï¼ˆdtype=torch.longï¼‰ä¸æœ€å¤§å…è®¸çš„episodeé•¿åº¦è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å°†ç»“æœå­˜å‚¨åˆ°ä¸€ä¸ªå½¢çŠ¶ä¸ºtorch.Size([num_envs])ï¼Œæ•°æ®ç±»å‹ä¸ºtorch.boolçš„å¼ é‡ä¸­ã€‚ ä¸‹é¢æ˜¯DirectRLEnv.max_episode_lengthçš„è®¡ç®—æ–¹æ³•ï¼š\n@property def max_episode_length_s(self) -\u0026gt; float: \u0026#34;\u0026#34;\u0026#34;Maximum episode length in seconds.\u0026#34;\u0026#34;\u0026#34; return self.cfg.episode_length_s @property def max_episode_length(self): \u0026#34;\u0026#34;\u0026#34;The maximum episode length in steps adjusted from s.\u0026#34;\u0026#34;\u0026#34; return math.ceil(self.max_episode_length_s / (self.cfg.sim.dt * self.cfg.decimation)) self.cfg.sim.dtï¼šåœ¨SimulationCfg.dtä¸­å®šä¹‰ï¼Œæ˜¯ç‰©ç†æ—¶é—´æ­¥é•¿ï¼ˆç§’ï¼‰ï¼Œself.cfg.sim.dt * self.cfg.decimationç”¨æ¥è®¡ç®—æ§åˆ¶åŠ¨ä½œè€Œæ‰§è¡Œé¢‘ç‡ã€‚ self.cfg.episode_length_sï¼šepisodeçš„æœ€å¤§é•¿åº¦ï¼ˆç§’ï¼‰ æ‰€ä»¥math.ceil(self.max_episode_length_s / (self.cfg.sim.dt * self.cfg.decimation))æ˜¯è®¡ç®—å‡ºæœ€å¤§çš„ç‰©ç†æ—¶é—´æ­¥æ•°å¹¶å‘ä¸Šå–æ•´ å°è½¦å’Œæ†å­çš„æ´»åŠ¨ç•Œé™è®¡ç®— torch.abs(self.joint_pos[:, self._cart_dof_idx])ï¼šè·å–å°è½¦ä½ç½®ä¿¡æ¯çš„ç»å¯¹å€¼ï¼Œè¿”å›çš„å¼ é‡å½¢çŠ¶ä¸ºï¼štorch.Size([N, 1]) ç„¶ååˆ¤æ–­å°è½¦ä½ç½®çš„ç»å¯¹å€¼æ˜¯å¦å¤§äºself.cfg.max_cart_poså€¼ï¼Œè¿™æ—¶å€™ä¼šè¿”å›ä¸€ä¸ªå½¢çŠ¶ä¸ºï¼štorch.Size([N, 1])ä¸”dtype=boolçš„å¼ é‡ æœ€åé€šè¿‡torch.anyå‡½æ•°è®¾ç½®dim=1æµ‹è¯•æ‰€æœ‰åˆ—çš„æ˜¯å¦ä¸ºTrueï¼Œå¹¶è¿”å›å½¢çŠ¶ä¸ºtorch.Size([N])çš„å¼ é‡ ","permalink":"https://fake-rick.github.io/posts/isaaclab%E5%88%9B%E5%BB%BA%E7%9B%B4%E6%8E%A5%E5%B7%A5%E4%BD%9C%E6%B5%81rl%E7%8E%AF%E5%A2%83/","summary":"\u003cp\u003eåŸæ–‡åœ°å€ï¼š\u003ca href=\"https://isaac-sim.github.io/IsaacLab/source/tutorials/03_envs/create_direct_rl_env.html\"\u003ehttps://isaac-sim.github.io/IsaacLab/source/tutorials/03_envs/create_direct_rl_env.html\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"ä»ç¯å¢ƒä¸­è·å–ä¿¡æ¯è§‚å¯Ÿ\"\u003eä»ç¯å¢ƒä¸­è·å–ä¿¡æ¯ï¼ˆè§‚å¯Ÿï¼‰\u003c/h2\u003e\n\u003ch3 id=\"è·å–jointé“°é“¾ä¿¡æ¯ä½ç½®å’Œé€Ÿåº¦\"\u003eè·å–jointï¼ˆé“°é“¾ï¼‰ä¿¡æ¯ï¼šä½ç½®å’Œé€Ÿåº¦\u003c/h3\u003e\n\u003cp\u003ejointä¼šè¢«åŒ…å«åœ¨Articulationï¼ˆå…³èŠ‚ï¼‰ä¸­ï¼Œä¸€ä¸ªArticulationå¯èƒ½ä¼šåŒ…å«1ä¸ªæˆ–å¤šä¸ªçš„jointå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡\u003ccode\u003eArticulation.find_joints()\u003c/code\u003eæ–¹æ³•è·å¾—jointåœ¨å½“å‰Articulationä¸­çš„ç´¢å¼•ï¼ˆindexï¼‰æ•°æ®ã€‚\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003efind_joints\u003c/code\u003eçš„è¿”å›å€¼æ˜¯è¿™æ ·çš„ï¼š\u003ccode\u003etuple[list[jointç´¢å¼•], list[jointåå­—]]\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003efind_jointsçš„å‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efind_joints\u003c/span\u003e( self, name_keys: str \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Sequence[str], joint_subset: list[str] \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNone\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNone\u003c/span\u003e, preserve_order: bool \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFalse\u003c/span\u003e ) \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e tuple[list[int], list[str]]\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eåœ¨Articulationå†…éƒ¨æœ‰ä¸€ä¸ªå±æ€§ç§æœ‰å˜é‡\u003ccode\u003e_data: ArticulationData\u003c/code\u003eï¼Œè¯¥å˜é‡é€šè¿‡æ–¹æ³•\u003ccode\u003edef data(self) -\u0026gt; ArticulationData\u003c/code\u003eè·å–ï¼Œåœ¨\u003ccode\u003eArticulationData\u003c/code\u003eä¸­å­˜æ”¾ç€å‡ ä¸ªå…³èŠ‚é‡è¦çš„æ•°æ®ï¼šä½ç½®\u003ccode\u003eArticulationData._joint_pos\u003c/code\u003eï¼Œé€Ÿåº¦\u003ccode\u003eArticulationData._joint_vel\u003c/code\u003eï¼ŒåŠ é€Ÿåº¦\u003ccode\u003eArticulationData._joint_acc\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eåœ¨\u003ccode\u003eArticulationData\u003c/code\u003eæœ‰å‡ ä¸ª\u003ccode\u003e@property\u003c/code\u003eè£…é¥°å™¨å‡½æ•°ï¼Œç”¨äºè·å–ä¸Šè¿°çš„ä¸‰ä¸ªå±æ€§ï¼Œè¿™æ ·å¯ä»¥ç”¨è¿‡å±æ€§åçš„æ–¹å¼ç›´æ¥è®¿é—®åˆ°è¿™äº›æ•°æ®ã€‚\u003c/p\u003e\n\u003cp\u003eä¸‹é¢ä»‹ç»ä¸‹è¿™ä¸‰ä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼š\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ejoint_pos\u003c/code\u003eè¿”å›\u003ccode\u003etorch.Size([num_instances, num_joints])\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ejoint_vel\u003c/code\u003eè¿”å›\u003ccode\u003etorch.Size([num_instances, num_joints])\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ejoint_acc\u003c/code\u003eè¿”å›\u003ccode\u003etorch.Size([num_instances, num_joints])\u003c/code\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eæ˜¯æ—¶å€™è®²è§£ä¸‹\u003ccode\u003eDirectRLEnv(gym.Env)._get_observations(self) -\u0026gt; VecEnvObs\u003c/code\u003eæ–¹æ³•äº†ï¼Œè¯¥æ–¹æ³•å¸¦æœ‰\u003ccode\u003e@abstractmethod\u003c/code\u003eè¢«å®šä¹‰æˆæŠ½è±¡æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç»§æ‰¿\u003ccode\u003eDirectRLEnv\u003c/code\u003eç±»åå¿…é¡»åœ¨è‡ªå·±çš„ç±»ä¸­å®ç°\u003ccode\u003e_get_observations\u003c/code\u003eæ–¹æ³•ã€‚\u003c/p\u003e\n\u003cp\u003eæˆ‘ä»¬åœ¨\u003ccode\u003e_get_observations\u003c/code\u003eæ–¹æ³•ä¸­è®¡ç®—å¹¶è¿”å›è§‚æµ‹å€¼ï¼Œè¿™ä¼šç”¨åˆ°ä¸Šé¢æåˆ°çš„\u003ccode\u003eArticulationData\u003c/code\u003eä»¥åŠå¦‚ä½•é€šè¿‡\u003ccode\u003ejoint\u003c/code\u003eç´¢å¼•ä»ä¸­è·å–å®é™…æ•°æ®ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨\u003ccode\u003ecartpole_env.py\u003c/code\u003eçš„ä»£ç ä¸­æœ‰å¦‚ä¸‹å®ç°ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003e_get_observations\u003c/span\u003e(self) \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e torch\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDict[str, torch\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTensor \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e torch\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDict[str, torch\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTensor]]:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tobs \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e torch\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecat(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tself\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejoint_pos[:, self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_pole_dof_idx[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eunsqueeze(dim\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tself\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejoint_vel[:, self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_pole_dof_idx[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eunsqueeze(dim\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tself\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejoint_pos[:, self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_cart_dof_idx[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eunsqueeze(dim\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tself\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejoint_vel[:, self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_cart_dof_idx[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eunsqueeze(dim\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdim\u003cspan style=\"color:#f92672\"\u003e=-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tobservations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;policy\u0026#34;\u003c/span\u003e: obs}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e observations\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eä¸Šè¿°ä»£ç ä¸­çš„\u003ccode\u003e_pole_dof_idx\u003c/code\u003eé‡Œè¾¹å­˜æ”¾çš„æ˜¯æ†å­çš„\u003ccode\u003ejoint\u003c/code\u003eå¯¹åº”çš„ç´¢å¼•æ•°æ®ï¼Œ\u003ccode\u003e_cart_dof_idx\u003c/code\u003eå­˜æ”¾çš„æ˜¯å°è½¦çš„\u003ccode\u003ejoint\u003c/code\u003eå¯¹åº”çš„ç´¢å¼•æ•°æ®ï¼Œè¿™é‡Œä»‹ç»ä¸‹è·å–æ†å­ä½ç½®çš„ä»£ç ï¼Œè·å–æ†å­é€Ÿåº¦å’Œå°è½¦ä½ç½®å’Œé€Ÿåº¦çš„ä»£ç éƒ½ä¸€æ ·ã€‚\u003c/p\u003e","title":"IsaacLabåˆ›å»ºç›´æ¥å·¥ä½œæµRLç¯å¢ƒ"},{"content":"Parkå˜æ¢ Parkå˜æ¢çš„ç›®çš„æ˜¯å°†Clarkå˜æ¢åçš„Î±Î²åæ ‡ç³»è½¬æ¢æˆd,qæ—‹è½¬åæ ‡ç³»ã€‚dè½´æ–¹å‘ä¸è½¬å­ç£é“¾æ–¹å‘é‡åˆï¼Œæ‰€ä»¥dè½´ä¹Ÿå«ç›´è½´ã€‚qè½´æ–¹å‘ä¸è½¬å­ç£é“¾æ–¹å‘å‚ç›´ï¼Œæ‰€ä»¥qè½´åˆå«äº¤è½´ã€‚\næ—‹è½¬çŸ©é˜µæ˜¯ä»€ä¹ˆï¼Ÿ âŠ¿aboï¼š $ob = oa\\times \\cos(\\theta)$\nå·²çŸ¥ï¼šbc = ad\n$$ \\because \\angle pad + \\angle pab = 90Â°\\\\ \\angle oab + \\angle pab = 90Â°\\\\ \\therefore \\angle oab = \\angle pad\\\\ \\angle aob = \\angle apd = \\angle \\theta $$âŠ¿adpï¼š $ad = ap \\times \\sin(\\theta)$\n$$ \\because oc = ob + bc \\\\ \\therefore oc = oa \\times \\cos(\\theta) + ap \\times \\sin(\\theta) $$æ‰€ä»¥å‘é‡påˆ°dè½´çš„æŠ•å½±ä¸ºï¼š$oa \\times \\cos(\\theta) + ap \\times \\sin(\\theta)$\nâŠ¿efoï¼š $of =oe \\times cos(\\theta)$\n$$ \\because \\angle peh + \\angle oeh = 90Â°\\\\ \\angle oef + \\angle oeh = 90Â°\\\\ \\therefore \\angle peh = \\angle oef $$å·²çŸ¥ï¼šfg = eh\nâŠ¿ephï¼š $eh = ep \\times sin(\\theta)$\næ‰€ä»¥ï¼š$fg = ep \\times sin(\\theta)$\n$$ \\because og = of - fg \\\\ \\therefore og = oe \\times cos(\\theta) - ep \\times \\sin(\\theta) $$æ‰€ä»¥å‘é‡påˆ°qè½´çš„æŠ•å½±ä¸ºï¼š$oe \\times cos(\\theta) - ep \\times \\sin(\\theta)$\nè®¾å‘é‡påœ¨Î±Î²åæ ‡ç³»çš„åæ ‡ï¼š$oa = ep = i\\alphaï¼Œoe = ap = i\\beta$\nå¯ä»¥å¾—åˆ°æ—‹è½¬çŸ©é˜µï¼š\n$$ \\left[ \\begin{matrix} id \\\\ iq \\end{matrix} \\right] \\left[ \\begin{matrix} \\cos(\\theta) \u0026 \\sin(\\theta) \\\\ -\\sin(\\theta) \u0026 \\cos(\\theta) \\end{matrix} \\right] \\left[ \\begin{matrix} i\\alpha \\\\ i\\beta \\end{matrix} \\right] $$æµ‹è¯• plt.figure(figsize=(10, 3)) def U(m, e): return (m * np.cos(e), m * np.cos(e + 2 * np.pi / 3), m * np.cos(e - 2 * np.pi / 3)) def Clark(a, b, c): return (2/3)*(np.mat([[1, -1/2, -1/2], [0, np.sqrt(3)/2, -np.sqrt(3)/2]]) * np.mat([a, b, c])) def Park(ia, ib, theta): return np.mat([[np.cos(theta), np.sin(theta)], [-np.sin(theta), np.cos(theta)]]) * np.array([ia, ib]) theta = np.arange(0, 6 * np.pi, 0.1) m = 1 (a, b, c) = U(m, np.pi / 4.0) td = Clark(np.array([a]),np.array([b]),np.array([c])) td = Park(td[0].tolist()[0],td[1].tolist()[0], np.pi) d = [] q = [] for t in theta: pd = Park(td[0].tolist()[0],td[1].tolist()[0], t).tolist() d.append(pd[0][0]) q.append(pd[1][0]) plt.plot(theta, d, label=\u0026#34;d\u0026#34;) plt.plot(theta, q, label=\u0026#34;q\u0026#34;) plt.xlabel=\u0026#34;x\u0026#34; plt.ylabel=\u0026#34;y\u0026#34; plt.title(\u0026#39;Park\u0026#39;) plt.legend() plt.show() ","permalink":"https://fake-rick.github.io/posts/park%E5%8F%98%E6%8D%A2/","summary":"\u003ch2 id=\"parkå˜æ¢\"\u003eParkå˜æ¢\u003c/h2\u003e\n\u003cp\u003eParkå˜æ¢çš„ç›®çš„æ˜¯å°†Clarkå˜æ¢åçš„Î±Î²åæ ‡ç³»è½¬æ¢æˆd,qæ—‹è½¬åæ ‡ç³»ã€‚dè½´æ–¹å‘ä¸è½¬å­ç£é“¾æ–¹å‘é‡åˆï¼Œæ‰€ä»¥dè½´ä¹Ÿå«ç›´è½´ã€‚qè½´æ–¹å‘ä¸è½¬å­ç£é“¾æ–¹å‘å‚ç›´ï¼Œæ‰€ä»¥qè½´åˆå«äº¤è½´ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"./imgs/a.png\" alt=\"\"  /\u003e\n\u003c/p\u003e\n\u003ch2 id=\"æ—‹è½¬çŸ©é˜µæ˜¯ä»€ä¹ˆ\"\u003eæ—‹è½¬çŸ©é˜µæ˜¯ä»€ä¹ˆï¼Ÿ\u003c/h2\u003e\n\u003ch3 id=\"abo\"\u003eâŠ¿aboï¼š\u003c/h3\u003e\n\u003cp\u003e$ob = oa\\times \\cos(\\theta)$\u003c/p\u003e\n\u003cp\u003eå·²çŸ¥ï¼š\u003cstrong\u003ebc = ad\u003c/strong\u003e\u003c/p\u003e\n$$\n\\because \\angle pad + \\angle pab = 90Â°\\\\ \\angle oab + \\angle pab = 90Â°\\\\ \\therefore \\angle oab = \\angle pad\\\\ \\angle aob = \\angle apd = \\angle \\theta \n$$\u003ch3 id=\"adp\"\u003eâŠ¿adpï¼š\u003c/h3\u003e\n\u003cp\u003e$ad = ap \\times \\sin(\\theta)$\u003c/p\u003e\n$$\n\\because oc = ob + bc \\\\ \\therefore oc = oa \\times \\cos(\\theta) + ap \\times \\sin(\\theta) \n$$\u003cp\u003eæ‰€ä»¥å‘é‡påˆ°dè½´çš„æŠ•å½±ä¸ºï¼š$oa \\times \\cos(\\theta) + ap \\times \\sin(\\theta)$\u003c/p\u003e","title":"Parkå˜æ¢"},{"content":" ä»€ä¹ˆæ˜¯Clarkå˜æ¢ï¼Ÿ Clarkå˜æ¢å°†ä¸‰ç›¸ç³»ç»Ÿï¼ˆåœ¨ abc åæ ‡ç³»ä¸­ï¼‰çš„æ—¶åŸŸåˆ†é‡è½¬æ¢ä¸ºæ­£äº¤é™æ­¢åæ ‡ç³» (Î±Î²) ä¸­çš„ä¸¤ä¸ªåˆ†é‡ã€‚\nåˆ©ç”¨åŸºå˜æ¢æ¥å®ç°ä¸‰ç›¸åæ ‡ç³»(abc)åˆ°ä¸¤ç›¸æ­£äº¤åæ ‡ç³»(Î±Î²) å·²çŸ¥ä¸‰ç›¸åæ ‡ç³»çš„ç›¸ä½ä¾æ¬¡ç›¸å·®120Â°ä¸”Î±Î²ä¸ºæ­£äº¤åæ ‡ç³»ã€‚ å°†Î±è½´ä¸aè½´é‡å ï¼Œå°†å‘é‡aæ²¿ç€åŸç‚¹Oçš„æ–¹å‘å»¶é•¿åšä¸€æ¡è¾…åŠ©çº¿ï¼Œâˆ boeå’Œâˆ coeç­‰äº60Â°ã€‚\nè®¡ç®—å‘é‡bå’Œå‘é‡cåˆ°Î±è½´çš„æŠ•å½±é•¿åº¦ï¼š $$ be = \\sin(âˆ boe) = \\sin(60Â°) = \\frac{\\sqrt{3}}{2} \\\\ ce = -\\sin(âˆ coe) = -\\sin(60Â°) = -\\frac{\\sqrt{3}}{2} $$å› ä¸ºå‘é‡cåœ¨Î±è½´çš„ä¸‹æ–¹æ‰€ä»¥æŠ•å½±ä¸ºè´Ÿ\nè®¡ç®—å‘é‡bå’Œå‘é‡cåˆ°Î²è½´çš„æŠ•å½±é•¿åº¦ï¼š $$ bg = -\\cos(âˆ boe) = -\\cos(60Â°) = -\\frac{1}{2} \\\\ ch = -\\cos(âˆ coe) = -\\cos(60Â°) = -\\frac{1}{2} $$å› ä¸ºå‘é‡bå’Œå‘é‡cåœ¨Î²è½´çš„å·¦ä¾§æ‰€ä»¥æŠ•å½±ä¸ºè´Ÿ\nç»„åˆå‡ºåŸºå˜æ¢çŸ©é˜µ æ ¹æ®ä¸Šé¢çš„æŠ•å½±å¯ä»¥å¾—åˆ°a,b,cä¸‰ä¸ªå‘é‡çš„åæ ‡ï¼šå‘é‡ $a=[1, 0]$ï¼Œå‘é‡$b=[-\\frac{1}{2},\\frac{\\sqrt{3}}{2}] $ï¼Œå‘é‡ $c=[-\\frac{1}{2},-\\frac{\\sqrt{3}}{2}] $\næ‰€ä»¥åŸºå˜æ¢çŸ©é˜µä¸ºï¼š\n$$ A = \\left[ \\begin{matrix} 1 \u0026 -\\frac{1}{2} \u0026 -\\frac{1}{2} \\\\ 0 \u0026 \\frac{\\sqrt{3}}{2}\u0026 -\\frac{\\sqrt{3}}{2} \\end{matrix} \\right] $$åæ ‡è½¬æ¢å…¬å¼ä¸ºï¼š\n$$ \\left[ \\begin{matrix} i\\alpha \\\\ i\\beta \\end{matrix} \\right] = \\left[ \\begin{matrix} 1 \u0026 -\\frac{1}{2} \u0026 -\\frac{1}{2} \\\\ 0 \u0026 \\frac{\\sqrt{3}}{2}\u0026 -\\frac{\\sqrt{3}}{2} \\end{matrix} \\right] \\left[ \\begin{matrix} ia \\\\ ib \\\\ ic \\end{matrix} \\right] $$$$ i\\alpha = ia - \\frac{1}{2}ib - \\frac{1}{2}ic \\\\ i\\beta = \\frac{\\sqrt{3}}{2}ib - \\frac{\\sqrt{3}}{2}ic $$åŸºå°”éœå¤«ç”µæµå®šå¾‹ï¼š æ‰€æœ‰è¿›å…¥æŸä¸ªèŠ‚ç‚¹çš„ç”µæµçš„æ€»å’Œç­‰äºæ‰€æœ‰ç¦»å¼€è¿™ä¸ªèŠ‚ç‚¹çš„ç”µæµçš„æ€»å’Œã€‚å‡è®¾è¿›å…¥æŸèŠ‚ç‚¹çš„ç”µæµä¸ºæ­£å€¼ï¼Œç¦»å¼€è¿™ä¸ªèŠ‚ç‚¹çš„ç”µæµä¸ºè´Ÿå€¼ï¼Œåˆ™æ‰€æœ‰è®¾è®¡è¿™ä¸ªèŠ‚ç‚¹çš„ç”µæµçš„ä»£æ•°å’Œç­‰äºé›¶ã€‚\n$ \\sum_{k=1}^{n}(ik)=0 $\næ‰€ä»¥ï¼šia + ib + ic = 0ï¼Œic = -(ia+ib)\nä½¿ç”¨iaå’Œibå°†å…¬å¼ä¸­çš„icæ¶ˆé™¤åçš„å…¬å¼ï¼š $$ i\\alpha = ia - \\frac{1}{2}ib + \\frac{1}{2}(ia+ib)\\\\ = ia - \\frac{1}{2}ib + \\frac{1}{2}ia+\\frac{1}{2}ib\\\\ =\\frac{3}{2}ia $$$$ i\\beta = \\frac{\\sqrt{3}}{2}ib + \\frac{\\sqrt{3}}{2}(ia+ib)\\\\ = \\frac{\\sqrt{3}}{2}(ia+2\\times ib) $$ç­‰å¹…å€¼å˜æ¢ å› ä¸ºï¼š$i\\alpha = \\frac{3}{2}ia$ï¼Œæ‰€ä»¥éœ€è¦åœ¨åŸºå˜æ¢åä¹˜ä»¥$\\frac{2}{3}$ä½¿å¾—$i\\alpha = ia$ï¼Œ$i\\beta = \\frac{\\sqrt{3}}{3}(ia+2\\times ib) $\nå¯¹åº”çš„åŸºå˜æ¢çŸ©é˜µä¸ºï¼š\n$$ \\left[ \\begin{matrix} i\\alpha \\\\ i\\beta \\end{matrix} \\right] =\\frac{2}{3} \\left[ \\begin{matrix} 1 \u0026 -\\frac{1}{2} \u0026 -\\frac{1}{2} \\\\ 0 \u0026 \\frac{\\sqrt{3}}{2}\u0026 -\\frac{\\sqrt{3}}{2} \\end{matrix} \\right] \\left[ \\begin{matrix} ia \\\\ ib \\\\ ic \\end{matrix} \\right] $$æµ‹è¯• ä¸ºæ ‡å‡†ä¸‰ç›¸ç”µå‹Uaã€Ubã€Ucåœ¨ç©ºé—´ä¸Šäº’å·®120Â°ï¼ŒVmä¸ºç›¸ç”µå‹å³°å€¼, $\\theta$ä¸ºç”µè§’åº¦ï¼š\n$$ Ua = Vm\\times \\cos(\\theta)\\\\ Ub = Vm\\times \\cos(\\theta+\\frac{2\\pi}{3})\\\\ Uc = Vm\\times \\cos(\\theta-\\frac{2\\pi}{3}) $$å¯¼å…¥åŒ…:\nimport numpy as np import matplotlib.pyplot as plt %matplotlib inline ä¸‰ç›¸é€†å˜è¾“å‡ºçš„ä¸‰ç›¸ç”µå‹æ³¢å½¢ï¼š\nplt.figure(figsize=(10, 3)) def U(m, e): return (m * np.cos(e), m * np.cos(e + 2 * np.pi / 3), m * np.cos(e - 2 * np.pi / 3)) e = np.arange(0, 20, 0.1) m = 1 (a, b, c) = U(m, e) plt.plot(e, a, label=\u0026#34;a\u0026#34;) plt.plot(e, b, label=\u0026#34;b\u0026#34;) plt.plot(e, c, label=\u0026#34;c\u0026#34;) plt.xlabel=\u0026#34;x\u0026#34; plt.ylabel=\u0026#34;y\u0026#34; plt.title(\u0026#39;\u0026#39;) plt.legend() plt.show() ç»è¿‡Clarkå˜æ¢åçš„æ³¢å½¢:\nplt.figure(figsize=(10, 3)) def U(m, e): return (m * np.cos(e), m * np.cos(e + 2 * np.pi / 3), m * np.cos(e - 2 * np.pi / 3)) def A(a, b, c): return (2/3)*(np.mat([[1, -1/2, -1/2], [0, np.sqrt(3)/2, -np.sqrt(3)/2]]) * np.mat([a, b, c])) e = np.arange(0, 20, 0.1) m = 1 (a, b, c) = U(m, e) d = A(a,b,c) plt.plot(e, d[0].tolist()[0], label=\u0026#34;alpha\u0026#34;) plt.plot(e, d[1].tolist()[0], label=\u0026#34;beta\u0026#34;) plt.xlabel=\u0026#34;x\u0026#34; plt.ylabel=\u0026#34;y\u0026#34; plt.title(\u0026#39;Clark\u0026#39;) plt.legend() plt.show() å¦‚æœå°†Clarkå˜æ¢ä¸­çš„ç³»æ•°$\\frac{2}{3}$å»æ‰åä¼šå‘ç°å¹…å€¼å’Œä¸‰ç›¸é€†å˜è¾“å‡ºçš„ä¸‰ç›¸ç”µå‹æ³¢å½¢æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¹…åº¦å¤šäº†1.5å€ï¼š\n","permalink":"https://fake-rick.github.io/posts/clark%E5%8F%98%E6%8D%A2%E7%9F%A9%E9%98%B5/","summary":"\u003cp\u003e\u003cimg loading=\"lazy\" src=\"./imgs/a.png\" alt=\"\"  /\u003e\n\u003c/p\u003e\n\u003ch2 id=\"ä»€ä¹ˆæ˜¯clarkå˜æ¢\"\u003eä»€ä¹ˆæ˜¯Clarkå˜æ¢ï¼Ÿ\u003c/h2\u003e\n\u003cp\u003eClarkå˜æ¢å°†ä¸‰ç›¸ç³»ç»Ÿï¼ˆåœ¨ abc åæ ‡ç³»ä¸­ï¼‰çš„æ—¶åŸŸåˆ†é‡è½¬æ¢ä¸ºæ­£äº¤é™æ­¢åæ ‡ç³» (Î±Î²) ä¸­çš„ä¸¤ä¸ªåˆ†é‡ã€‚\u003c/p\u003e\n\u003ch2 id=\"åˆ©ç”¨åŸºå˜æ¢æ¥å®ç°ä¸‰ç›¸åæ ‡ç³»abcåˆ°ä¸¤ç›¸æ­£äº¤åæ ‡ç³»Î±Î²\"\u003eåˆ©ç”¨åŸºå˜æ¢æ¥å®ç°ä¸‰ç›¸åæ ‡ç³»(abc)åˆ°ä¸¤ç›¸æ­£äº¤åæ ‡ç³»(Î±Î²)\u003c/h2\u003e\n\u003cp\u003eå·²çŸ¥ä¸‰ç›¸åæ ‡ç³»çš„ç›¸ä½ä¾æ¬¡ç›¸å·®120Â°ä¸”Î±Î²ä¸ºæ­£äº¤åæ ‡ç³»ã€‚\nå°†Î±è½´ä¸aè½´é‡å ï¼Œå°†å‘é‡aæ²¿ç€åŸç‚¹Oçš„æ–¹å‘å»¶é•¿åšä¸€æ¡è¾…åŠ©çº¿ï¼Œâˆ boeå’Œâˆ coeç­‰äº60Â°ã€‚\u003c/p\u003e\n\u003ch2 id=\"è®¡ç®—å‘é‡bå’Œå‘é‡cåˆ°Î±è½´çš„æŠ•å½±é•¿åº¦\"\u003eè®¡ç®—å‘é‡bå’Œå‘é‡cåˆ°Î±è½´çš„æŠ•å½±é•¿åº¦ï¼š\u003c/h2\u003e\n$$\nbe = \\sin(âˆ boe) = \\sin(60Â°) = \\frac{\\sqrt{3}}{2}  \\\\ ce = -\\sin(âˆ coe) = -\\sin(60Â°) = -\\frac{\\sqrt{3}}{2}  \n$$\u003cp\u003eå› ä¸ºå‘é‡cåœ¨Î±è½´çš„ä¸‹æ–¹æ‰€ä»¥æŠ•å½±ä¸ºè´Ÿ\u003c/p\u003e\n\u003ch2 id=\"è®¡ç®—å‘é‡bå’Œå‘é‡cåˆ°Î²è½´çš„æŠ•å½±é•¿åº¦\"\u003eè®¡ç®—å‘é‡bå’Œå‘é‡cåˆ°Î²è½´çš„æŠ•å½±é•¿åº¦ï¼š\u003c/h2\u003e\n$$\nbg = -\\cos(âˆ boe) = -\\cos(60Â°) = -\\frac{1}{2}  \\\\   \nch = -\\cos(âˆ coe) = -\\cos(60Â°) = -\\frac{1}{2}  \n$$\u003cp\u003eå› ä¸ºå‘é‡bå’Œå‘é‡cåœ¨Î²è½´çš„å·¦ä¾§æ‰€ä»¥æŠ•å½±ä¸ºè´Ÿ\u003c/p\u003e\n\u003ch2 id=\"ç»„åˆå‡ºåŸºå˜æ¢çŸ©é˜µ\"\u003eç»„åˆå‡ºåŸºå˜æ¢çŸ©é˜µ\u003c/h2\u003e\n\u003cp\u003eæ ¹æ®ä¸Šé¢çš„æŠ•å½±å¯ä»¥å¾—åˆ°a,b,cä¸‰ä¸ªå‘é‡çš„åæ ‡ï¼šå‘é‡ $a=[1, 0]$ï¼Œå‘é‡$b=[-\\frac{1}{2},\\frac{\\sqrt{3}}{2}] $ï¼Œå‘é‡ $c=[-\\frac{1}{2},-\\frac{\\sqrt{3}}{2}] $\u003c/p\u003e\n\u003cp\u003eæ‰€ä»¥åŸºå˜æ¢çŸ©é˜µä¸ºï¼š\u003c/p\u003e\n$$\nA =  \\left[ \\begin{matrix} 1 \u0026 -\\frac{1}{2} \u0026 -\\frac{1}{2} \\\\ 0 \u0026 \\frac{\\sqrt{3}}{2}\u0026 -\\frac{\\sqrt{3}}{2} \\end{matrix} \\right] \n$$\u003cp\u003eåæ ‡è½¬æ¢å…¬å¼ä¸ºï¼š\u003c/p\u003e","title":"Clarkå˜æ¢çŸ©é˜µ"},{"content":"QTcpSocketèƒ½å¤Ÿæ£€æµ‹åˆ°Socketçš„è¿æ¥ä¸æ–­å¼€çŠ¶æ€ï¼Œå¹¶è§¦å‘ç›¸å…³ä¿¡å·ï¼Œæˆ‘ä»¬åªéœ€è¦å…³è”ä¿¡å·ä¸æ§½å°±èƒ½å¤ŸçŸ¥é“è¿æ¥çŠ¶æ€ã€‚\nconnect(\u0026amp;m_socket, \u0026amp;QTcpSocket::connected, this, \u0026amp;TcpClient::onConnected, Qt::QueuedConnection); connect(\u0026amp;m_socket, \u0026amp;QTcpSocket::disconnected, this, \u0026amp;TcpClient::onDisconnected, Qt::QueuedConnection); è¿˜æœ‰ä¸€äº›ç‰¹æ®Šæƒ…å†µæ˜¯æ— æ³•è§¦å‘QTcpSocket::disconnectedä¿¡å·ï¼Œæ¯”å¦‚è¯´ï¼šç½‘çº¿çªç„¶æ‹”äº†ã€å¯¹ç«¯è®¾å¤‡çªç„¶çˆ†æ‰äº†ç­‰ã€‚è¿™ç±»æƒ…å†µç”±äºå¯¹ç«¯socketæœªæ­£å¸¸è°ƒç”¨close()æ–¹æ³•è€Œå¯¼è‡´çš„ã€‚\næˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå¿ƒè·³åŒ…å»å®šæœŸæ£€æŸ¥å¯¹ç«¯çš„å­˜æ´»çŠ¶æ€ï¼Œè¿™ç§åšæ³•åœ¨åè®®è¿˜æœªæŒ‡å®šçš„åˆæœŸæ˜¯æ¯”è¾ƒé€‚åˆçš„ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯åˆ¶å®šä¸€å¥—å¿ƒè·³è¯·æ±‚ä¸åº”ç­”æœºåˆ¶æ¥åˆ¤æ–­å¯¹ç«¯çš„å­˜æ´»çŠ¶æ€ã€‚ä½†æ˜¯å¾€å¾€ä¸‹ä½æœºçš„ç¨‹åºå·²ç»å­˜åœ¨ï¼ˆå¼€å‘è€…ä¸æ„¿æ„ä¿®æ”¹æˆ–å¢åŠ ç°æœ‰åè®®ï¼‰ï¼Œè¿™æ—¶å€™å¦‚ä½•èƒ½å¤Ÿåœ¨ç‰¹æ®Šæƒ…å†µä¸‹æ£€æµ‹åˆ°ç½‘ç»œæ–­å¼€å‘¢ï¼Ÿ\nä¸»è§’ç™»åœºï¼šKeepaliveæœºåˆ¶\nkeepaliveç®€ä»‹ï¼ˆæ‘˜è‡ªç»´åŸºç™¾ç§‘ï¼‰ ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰å­˜æ´»åŒ…ä¸ºå¯é€‰ç‰¹æ€§ï¼Œä¸”é»˜è®¤å…³é—­ã€‚å­˜æ´»åŒ…å†…æ²¡æœ‰æ•°æ®ã€‚åœ¨ä»¥å¤ªç½‘ç½‘ç»œä¸­ï¼Œå­˜æ´»åŒ…çš„å¤§å°ä¸ºæœ€å°é•¿åº¦çš„å‡ å¸§ï¼ˆ64å­—èŠ‚ï¼‰ã€‚åè®®ä¸­ï¼Œè¿˜æœ‰ä¸‰ä¸ªä¸å­˜æ´»åŒ…ç›¸å…³çš„å‚æ•°ï¼š\nå­˜æ´»æ—¶é•¿ï¼ˆè‹±è¯­ï¼šKeepalive timeï¼‰å³ç©ºé—²æ—¶ï¼Œä¸¤æ¬¡ä¼ è¾“å­˜æ´»åŒ…çš„æŒç»­æ—¶é—´ã€‚TCPå­˜æ´»åŒ…æ—¶é•¿å¯æ‰‹åŠ¨é…ç½®ï¼Œé»˜è®¤ä¸å°‘äº2ä¸ªå°æ—¶ã€‚ å­˜æ´»é—´éš”ï¼ˆè‹±è¯­ï¼šKeepalive intervalï¼‰å³æœªæ”¶åˆ°ä¸Šä¸ªå­˜æ´»åŒ…æ—¶ï¼Œä¸¤æ¬¡è¿ç»­ä¼ è¾“å­˜æ´»åŒ…çš„æ—¶é—´é—´éš”ã€‚ å­˜æ´»é‡è¯•æ¬¡æ•°ï¼ˆè‹±è¯­ï¼šKeepalive retryï¼‰å³åœ¨åˆ¤æ–­è¿œç¨‹ä¸»æœºä¸å¯ç”¨å‰çš„å‘é€å­˜æ´»åŒ…æ¬¡æ•°ã€‚å½“ä¸¤ä¸ªä¸»æœºé€è¿‡TCP/IPåè®®ç›¸è¿æ—¶ï¼ŒTCPå­˜æ´»åŒ…å¯ç”¨äºåˆ¤æ–­è¿æ¥æ˜¯å¦å¯ç”¨ï¼Œå¹¶æŒ‰éœ€ä¸­æ–­ã€‚ å¤šæ•°æ”¯æŒTCPåè®®çš„ä¸»æœºä¹ŸåŒæ—¶æ”¯æŒTCPå­˜æ´»åŒ…ã€‚æ¯ä¸ªä¸»æœºæŒ‰ä¸€å®šå‘¨æœŸå‘å…¶ä»–ä¸»æœºå‘é€TCPåŒ…æ¥è¯·æ±‚å›åº”ã€‚è‹¥å‘é€ä¸»æœºæœªæ”¶åˆ°ç‰¹å®šä¸»æœºçš„å›åº”ï¼ˆACKï¼‰ï¼Œåˆ™å°†ä»å‘é€ä¸»æœºä¸€ä¾§ä¸­æ–­è¿æ¥ã€‚ è‹¥å…¶ä»–ä¸»æœºåœ¨è¿æ¥å…³é—­åå‘é€TCPå­˜æ´»åŒ…ï¼Œå…³é—­è¿æ¥çš„ä¸€æ–¹å°†å‘é€RSTåŒ…æ¥è¡¨æ˜æ—§è¿æ¥å·²ä¸å¯ç”¨ã€‚å…¶ä»–ä¸»æœºå°†å…³é—­å®ƒä¸€ä¾§çš„è¿æ¥ä»¥æ–°å»ºè¿æ¥ã€‚ ç©ºé—²çš„TCPè¿æ¥é€šå¸¸ä¼šéš”æ¯45ç§’æˆ–60ç§’å‘é€ä¸€æ¬¡å­˜æ´»åŒ…ã€‚åœ¨æœªè¿ç»­æ”¶åˆ°ä¸‰æ¬¡ACKåŒ…æ—¶ï¼Œè¿æ¥å°†ä¸­æ–­ã€‚æ­¤è¡Œä¸ºå› ä¸»æœºè€Œå¼‚ï¼Œå¦‚é»˜è®¤æƒ…å†µä¸‹çš„Windowsä¸»æœºå°†åœ¨7200000msï¼ˆ2å°æ—¶ï¼‰åå‘é€é¦–ä¸ªå­˜æ´»åŒ…ï¼Œéšåå†ä»¥1000msçš„é—´éš”å‘é€5ä¸ªå­˜æ´»åŒ…ã€‚è‹¥ä»»æ„å­˜æ´»åŒ…æœªæ”¶åˆ°å›åº”ï¼Œè¿æ¥å°†è¢«ä¸­æ–­ã€‚\nQtå¼€å¯Keepaliveï¼ˆLinuxä¸Windowsï¼‰ #include \u0026#34;keepalive.h\u0026#34; #include \u0026lt;QObject\u0026gt; const int keepalive = 1; // å¼€å¯keepaliveå±æ€§ const int keepidle = 5; // å¦‚æœè¿æ¥åœ¨5ç§’å†…æ²¡æœ‰ä»»ä½•æ•°æ®æ¥å¾€åˆ™è¿›è¡Œæ¢æµ‹ const int keepinterval = 3; // æ¢æµ‹æ—¶å‘åŒ…çš„æ—¶é—´é—´éš”ä¸º3ç§’ const int keepcount = 3; // å°è¯•æ¢æµ‹çš„æ¬¡æ•°ï¼Œ å¦‚æœç¬¬ä¸€æ¬¡æ¢æµ‹åŒ…å°±æ”¶åˆ°å“åº”ï¼Œåˆ™ä¸åœ¨ç»§ç»­æ¢æµ‹ #if defined (Q_OS_LINUX) || defined (Q_OS_MACOS) #include \u0026lt;sys/socket.h\u0026gt; #include \u0026lt;sys/types.h\u0026gt; #include \u0026lt;netinet/tcp.h\u0026gt; #include \u0026lt;netinet/in.h\u0026gt; // å¼€å¯TCPå¿ƒè·³æ£€æµ‹æœºåˆ¶ int enableKeepalive(int fd) { if (setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, \u0026amp;keepalive, sizeof(keepalive)) \u0026lt; 0) return -1; if (setsockopt(fd, SOL_TCP, TCP_KEEPIDLE, \u0026amp;keepidle, sizeof(keepidle)) \u0026lt; 0) return -1; if (setsockopt(fd, SOL_TCP, TCP_KEEPINTVL, \u0026amp;keepinterval, sizeof(keepinterval)) \u0026lt; 0) return -1; if (setsockopt(fd, SOL_TCP, TCP_KEEPCNT, \u0026amp;keepcount, sizeof(keepcount)) \u0026lt; 0) return -1; return 0; } #elif defined (Q_OS_WIN) #include \u0026lt;winsock2.h\u0026gt; #define SIO_KEEPALIVE_VALS _WSAIOW(IOC_VENDOR,4) struct tcp_keepalive { unsigned long onoff; unsigned long keepalivetime; unsigned long keepaliveinterval; }; int enableKeepalive(int fd) { if (setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, (char*)\u0026amp;keepalive, sizeof(keepalive)) \u0026lt; 0) return -1; struct tcp_keepalive in_keep_alive; memset(\u0026amp;in_keep_alive, 0, sizeof(in_keep_alive)); unsigned long ul_in_len = sizeof(struct tcp_keepalive); struct tcp_keepalive out_keep_alive; memset(\u0026amp;out_keep_alive, 0, sizeof(out_keep_alive)); unsigned long ul_out_len = sizeof(struct tcp_keepalive); unsigned long ul_bytes_return = 0; in_keep_alive.onoff = 1; // æ‰“å¼€keepalive in_keep_alive.keepaliveinterval = keepinterval * 1000; // å‘é€keepaliveå¿ƒè·³æ—¶é—´é—´éš”-å•ä½ä¸ºæ¯«ç§’ in_keep_alive.keepalivetime = keepidle * 1000; // å¤šé•¿æ—¶é—´æ²¡æœ‰æŠ¥æ–‡å¼€å§‹å‘é€keepaliveå¿ƒè·³åŒ…-å•ä½ä¸ºæ¯«ç§’ if (WSAIoctl(fd, SIO_KEEPALIVE_VALS, (LPVOID)\u0026amp;in_keep_alive, ul_in_len, (LPVOID)\u0026amp;out_keep_alive, ul_out_len, \u0026amp;ul_bytes_return, NULL, NULL) \u0026lt; 0) return -1; return 0; } #else int enableKeepalive(int fd) { Q_UNUSED(fd); return -1; } #endif Socketæ–‡ä»¶æè¿°ç¬¦çš„è·å– QAbstractSocket::socketDescriptor() ï¼Œåœ¨socketè¿æ¥æˆåŠŸåå¯ä½¿é€šè¿‡m_socket-\u0026gt;socketDescriptor();è·å–åˆ°QTcpSocketçš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆFDï¼‰,å¤±è´¥æ—¶è¿”å›-1ï¼Œè¿™è¾¹è·å–åˆ°çš„fdå¯ä»¥æä¾›ç»™int enableKeepalive(int fd);ä½œä¸ºå‚æ•°ç”¨äºå¯ç”¨keepaliveã€‚\næ–‡æ¡£ä»‹ç»ï¼š\nReturns the native socket descriptor of the QAbstractSocket object if this is available; otherwise returns -1.\nIf the socket is using QNetworkProxy, the returned descriptor may not be usable with native socket functions.\nThe socket descriptor is not available when QAbstractSocket is in UnconnectedState.\næ–­çº¿é‡è¿ åœ¨å¼€å¯keepaliveåæˆ‘ä»¬å°±å¯ä»¥åœ¨é“¾è·¯æ–­å¼€æ—¶è§¦å‘QTcpSocket::disconnectedä¿¡å·äº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬åªéœ€è¦å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨å»è¯•è¯•æ£€æŸ¥QTcpSocketçš„çŠ¶æ€ï¼Œå½“çŠ¶æ€ä¸ºQAbstractSocket::UnconnectedStateæ—¶æ¸…ç†QTcpSocketèµ„æºå¹¶å°è¯•é‡æ–°ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥å³å¯ã€‚\n// çŠ¶æ€æ£€æŸ¥å®šæ—¶å™¨æ§½å‡½æ•° void TcpClient::onCheckState() { switch (m_socket.state()) { case QAbstractSocket::UnconnectedState: m_socket.close(); m_socket.abort(); m_socket.connectToHost(m_remoteIp, m_remotePort); break; case QAbstractSocket::HostLookupState: break; case QAbstractSocket::ConnectingState: break; case QAbstractSocket::ConnectedState: break; case QAbstractSocket::BoundState: break; case QAbstractSocket::ListeningState: break; case QAbstractSocket::ClosingState: break; } } ","permalink":"https://fake-rick.github.io/posts/qt%E4%BD%BF%E7%94%A8keepalive%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0%E6%96%AD%E7%BA%BF%E9%87%8D%E8%BF%9E/","summary":"\u003cp\u003e\u003ccode\u003eQTcpSocket\u003c/code\u003eèƒ½å¤Ÿæ£€æµ‹åˆ°Socketçš„è¿æ¥ä¸æ–­å¼€çŠ¶æ€ï¼Œå¹¶è§¦å‘ç›¸å…³ä¿¡å·ï¼Œæˆ‘ä»¬åªéœ€è¦å…³è”ä¿¡å·ä¸æ§½å°±èƒ½å¤ŸçŸ¥é“è¿æ¥çŠ¶æ€ã€‚\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-c++\" data-lang=\"c++\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econnect(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003em_socket, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eQTcpSocket\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003econnected, \u003cspan style=\"color:#66d9ef\"\u003ethis\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eTcpClient\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003eonConnected, Qt\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003eQueuedConnection);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econnect(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003em_socket, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eQTcpSocket\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003edisconnected, \u003cspan style=\"color:#66d9ef\"\u003ethis\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eTcpClient\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003eonDisconnected, Qt\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003eQueuedConnection);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè¿˜æœ‰ä¸€äº›ç‰¹æ®Šæƒ…å†µæ˜¯æ— æ³•è§¦å‘\u003ccode\u003eQTcpSocket::disconnected\u003c/code\u003eä¿¡å·ï¼Œæ¯”å¦‚è¯´ï¼šç½‘çº¿çªç„¶æ‹”äº†ã€å¯¹ç«¯è®¾å¤‡çªç„¶çˆ†æ‰äº†ç­‰ã€‚è¿™ç±»æƒ…å†µç”±äºå¯¹ç«¯socketæœªæ­£å¸¸è°ƒç”¨\u003ccode\u003eclose()\u003c/code\u003eæ–¹æ³•è€Œå¯¼è‡´çš„ã€‚\u003c/p\u003e\n\u003cp\u003eæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå¿ƒè·³åŒ…å»å®šæœŸæ£€æŸ¥å¯¹ç«¯çš„å­˜æ´»çŠ¶æ€ï¼Œè¿™ç§åšæ³•åœ¨åè®®è¿˜æœªæŒ‡å®šçš„åˆæœŸæ˜¯æ¯”è¾ƒé€‚åˆçš„ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯åˆ¶å®šä¸€å¥—å¿ƒè·³è¯·æ±‚ä¸åº”ç­”æœºåˆ¶æ¥åˆ¤æ–­å¯¹ç«¯çš„å­˜æ´»çŠ¶æ€ã€‚ä½†æ˜¯å¾€å¾€ä¸‹ä½æœºçš„ç¨‹åºå·²ç»å­˜åœ¨ï¼ˆå¼€å‘è€…ä¸æ„¿æ„ä¿®æ”¹æˆ–å¢åŠ ç°æœ‰åè®®ï¼‰ï¼Œè¿™æ—¶å€™å¦‚ä½•èƒ½å¤Ÿåœ¨ç‰¹æ®Šæƒ…å†µä¸‹æ£€æµ‹åˆ°ç½‘ç»œæ–­å¼€å‘¢ï¼Ÿ\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eä¸»è§’ç™»åœºï¼šKeepaliveæœºåˆ¶\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"keepaliveç®€ä»‹æ‘˜è‡ªç»´åŸºç™¾ç§‘\"\u003ekeepaliveç®€ä»‹ï¼ˆæ‘˜è‡ªç»´åŸºç™¾ç§‘ï¼‰\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰å­˜æ´»åŒ…ä¸ºå¯é€‰ç‰¹æ€§ï¼Œä¸”é»˜è®¤å…³é—­ã€‚å­˜æ´»åŒ…å†…æ²¡æœ‰æ•°æ®ã€‚åœ¨ä»¥å¤ªç½‘ç½‘ç»œä¸­ï¼Œå­˜æ´»åŒ…çš„å¤§å°ä¸ºæœ€å°é•¿åº¦çš„å‡ å¸§ï¼ˆ64å­—èŠ‚ï¼‰ã€‚åè®®ä¸­ï¼Œè¿˜æœ‰ä¸‰ä¸ªä¸å­˜æ´»åŒ…ç›¸å…³çš„å‚æ•°ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå­˜æ´»æ—¶é•¿ï¼ˆè‹±è¯­ï¼šKeepalive timeï¼‰å³ç©ºé—²æ—¶ï¼Œä¸¤æ¬¡ä¼ è¾“å­˜æ´»åŒ…çš„æŒç»­æ—¶é—´ã€‚TCPå­˜æ´»åŒ…æ—¶é•¿å¯æ‰‹åŠ¨é…ç½®ï¼Œé»˜è®¤ä¸å°‘äº2ä¸ªå°æ—¶ã€‚\u003c/li\u003e\n\u003cli\u003eå­˜æ´»é—´éš”ï¼ˆè‹±è¯­ï¼šKeepalive intervalï¼‰å³æœªæ”¶åˆ°ä¸Šä¸ªå­˜æ´»åŒ…æ—¶ï¼Œä¸¤æ¬¡è¿ç»­ä¼ è¾“å­˜æ´»åŒ…çš„æ—¶é—´é—´éš”ã€‚\u003c/li\u003e\n\u003cli\u003eå­˜æ´»é‡è¯•æ¬¡æ•°ï¼ˆè‹±è¯­ï¼šKeepalive retryï¼‰å³åœ¨åˆ¤æ–­è¿œç¨‹ä¸»æœºä¸å¯ç”¨å‰çš„å‘é€å­˜æ´»åŒ…æ¬¡æ•°ã€‚å½“ä¸¤ä¸ªä¸»æœºé€è¿‡TCP/IPåè®®ç›¸è¿æ—¶ï¼ŒTCPå­˜æ´»åŒ…å¯ç”¨äºåˆ¤æ–­è¿æ¥æ˜¯å¦å¯ç”¨ï¼Œå¹¶æŒ‰éœ€ä¸­æ–­ã€‚\nå¤šæ•°æ”¯æŒTCPåè®®çš„ä¸»æœºä¹ŸåŒæ—¶æ”¯æŒTCPå­˜æ´»åŒ…ã€‚æ¯ä¸ªä¸»æœºæŒ‰ä¸€å®šå‘¨æœŸå‘å…¶ä»–ä¸»æœºå‘é€TCPåŒ…æ¥è¯·æ±‚å›åº”ã€‚è‹¥å‘é€ä¸»æœºæœªæ”¶åˆ°ç‰¹å®šä¸»æœºçš„å›åº”ï¼ˆACKï¼‰ï¼Œåˆ™å°†ä»å‘é€ä¸»æœºä¸€ä¾§ä¸­æ–­è¿æ¥ã€‚ è‹¥å…¶ä»–ä¸»æœºåœ¨è¿æ¥å…³é—­åå‘é€TCPå­˜æ´»åŒ…ï¼Œå…³é—­è¿æ¥çš„ä¸€æ–¹å°†å‘é€RSTåŒ…æ¥è¡¨æ˜æ—§è¿æ¥å·²ä¸å¯ç”¨ã€‚å…¶ä»–ä¸»æœºå°†å…³é—­å®ƒä¸€ä¾§çš„è¿æ¥ä»¥æ–°å»ºè¿æ¥ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eç©ºé—²çš„TCPè¿æ¥é€šå¸¸ä¼šéš”æ¯45ç§’æˆ–60ç§’å‘é€ä¸€æ¬¡å­˜æ´»åŒ…ã€‚åœ¨æœªè¿ç»­æ”¶åˆ°ä¸‰æ¬¡ACKåŒ…æ—¶ï¼Œè¿æ¥å°†ä¸­æ–­ã€‚æ­¤è¡Œä¸ºå› ä¸»æœºè€Œå¼‚ï¼Œå¦‚é»˜è®¤æƒ…å†µä¸‹çš„Windowsä¸»æœºå°†åœ¨7200000msï¼ˆ2å°æ—¶ï¼‰åå‘é€é¦–ä¸ªå­˜æ´»åŒ…ï¼Œéšåå†ä»¥1000msçš„é—´éš”å‘é€5ä¸ªå­˜æ´»åŒ…ã€‚è‹¥ä»»æ„å­˜æ´»åŒ…æœªæ”¶åˆ°å›åº”ï¼Œè¿æ¥å°†è¢«ä¸­æ–­ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"qtå¼€å¯keepalivelinuxä¸windows\"\u003eQtå¼€å¯Keepaliveï¼ˆLinuxä¸Windowsï¼‰\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-c++\" data-lang=\"c++\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026#34;keepalive.h\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;QObject\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e keepalive \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;    \u003cspan style=\"color:#75715e\"\u003e// å¼€å¯keepaliveå±æ€§\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e keepidle \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e;     \u003cspan style=\"color:#75715e\"\u003e// å¦‚æœè¿æ¥åœ¨5ç§’å†…æ²¡æœ‰ä»»ä½•æ•°æ®æ¥å¾€åˆ™è¿›è¡Œæ¢æµ‹\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e keepinterval \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// æ¢æµ‹æ—¶å‘åŒ…çš„æ—¶é—´é—´éš”ä¸º3ç§’\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e keepcount \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e;    \u003cspan style=\"color:#75715e\"\u003e// å°è¯•æ¢æµ‹çš„æ¬¡æ•°ï¼Œ å¦‚æœç¬¬ä¸€æ¬¡æ¢æµ‹åŒ…å°±æ”¶åˆ°å“åº”ï¼Œåˆ™ä¸åœ¨ç»§ç»­æ¢æµ‹\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#if defined (Q_OS_LINUX) || defined (Q_OS_MACOS)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;sys/socket.h\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;sys/types.h\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;netinet/tcp.h\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;netinet/in.h\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// å¼€å¯TCPå¿ƒè·³æ£€æµ‹æœºåˆ¶\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eenableKeepalive\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e fd) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ekeepalive, \u003cspan style=\"color:#66d9ef\"\u003esizeof\u003c/span\u003e(keepalive)) \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (setsockopt(fd, SOL_TCP, TCP_KEEPIDLE, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ekeepidle, \u003cspan style=\"color:#66d9ef\"\u003esizeof\u003c/span\u003e(keepidle)) \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (setsockopt(fd, SOL_TCP, TCP_KEEPINTVL, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ekeepinterval, \u003cspan style=\"color:#66d9ef\"\u003esizeof\u003c/span\u003e(keepinterval)) \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (setsockopt(fd, SOL_TCP, TCP_KEEPCNT, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ekeepcount, \u003cspan style=\"color:#66d9ef\"\u003esizeof\u003c/span\u003e(keepcount)) \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#elif defined (Q_OS_WIN)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;winsock2.h\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#define SIO_KEEPALIVE_VALS _WSAIOW(IOC_VENDOR,4)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etcp_keepalive\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eunsigned\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003elong\u003c/span\u003e onoff;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eunsigned\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003elong\u003c/span\u003e keepalivetime;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eunsigned\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003elong\u003c/span\u003e keepaliveinterval;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e};\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eenableKeepalive\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e fd) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, (\u003cspan style=\"color:#66d9ef\"\u003echar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ekeepalive, \u003cspan style=\"color:#66d9ef\"\u003esizeof\u003c/span\u003e(keepalive)) \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etcp_keepalive\u003c/span\u003e in_keep_alive;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    memset(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ein_keep_alive, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003esizeof\u003c/span\u003e(in_keep_alive));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eunsigned\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003elong\u003c/span\u003e ul_in_len \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003esizeof\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etcp_keepalive\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etcp_keepalive\u003c/span\u003e out_keep_alive;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    memset(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eout_keep_alive, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003esizeof\u003c/span\u003e(out_keep_alive));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eunsigned\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003elong\u003c/span\u003e ul_out_len \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003esizeof\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etcp_keepalive\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eunsigned\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003elong\u003c/span\u003e ul_bytes_return \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    in_keep_alive.onoff \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;                                \u003cspan style=\"color:#75715e\"\u003e// æ‰“å¼€keepalive\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    in_keep_alive.keepaliveinterval \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e keepinterval \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e;  \u003cspan style=\"color:#75715e\"\u003e// å‘é€keepaliveå¿ƒè·³æ—¶é—´é—´éš”-å•ä½ä¸ºæ¯«ç§’\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    in_keep_alive.keepalivetime \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e keepidle \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e;          \u003cspan style=\"color:#75715e\"\u003e// å¤šé•¿æ—¶é—´æ²¡æœ‰æŠ¥æ–‡å¼€å§‹å‘é€keepaliveå¿ƒè·³åŒ…-å•ä½ä¸ºæ¯«ç§’\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (WSAIoctl(fd, SIO_KEEPALIVE_VALS, (LPVOID)\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ein_keep_alive, ul_in_len,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                               (LPVOID)\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eout_keep_alive, ul_out_len, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eul_bytes_return, NULL, NULL) \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#else\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eenableKeepalive\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e fd) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Q_UNUSED(fd);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#endif\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"socketæ–‡ä»¶æè¿°ç¬¦çš„è·å–\"\u003eSocketæ–‡ä»¶æè¿°ç¬¦çš„è·å–\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eQAbstractSocket::socketDescriptor() \u003c/code\u003eï¼Œåœ¨socketè¿æ¥æˆåŠŸåå¯ä½¿é€šè¿‡\u003ccode\u003em_socket-\u0026gt;socketDescriptor();\u003c/code\u003eè·å–åˆ°QTcpSocketçš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆFDï¼‰,å¤±è´¥æ—¶è¿”å›\u003ccode\u003e-1\u003c/code\u003eï¼Œè¿™è¾¹è·å–åˆ°çš„fdå¯ä»¥æä¾›ç»™\u003ccode\u003eint enableKeepalive(int fd);\u003c/code\u003eä½œä¸ºå‚æ•°ç”¨äºå¯ç”¨\u003ccode\u003ekeepalive\u003c/code\u003eã€‚\u003c/p\u003e","title":"Qtä½¿ç”¨Keepaliveæœºåˆ¶å®ç°æ–­çº¿é‡è¿"}]